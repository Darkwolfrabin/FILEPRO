import base64
exec(base64.b64decode("Iy0tPiBBdXRob3INCkF1dGhvciA9ICdEYXB1bnRhIEtodXJheXJhIFgnDQpWZXJzaW9uID0gMC4xDQpGYWNlYm9vayA9ICdGYWNlYm9vay5jb20vRGFwdW50YS5LaHVyYXlyYS5YJw0KSW5zdGFncmFtID0gJ0luc3RhZ3JhbS5jb20vcmF0eWEuYW5vbnltLmlkJw0KDQojLS0+IEltcG9ydCBNb2R1bGUNCmltcG9ydCBvcywgc3lzLCByZXF1ZXN0cywgYnM0LCByZSwgdGltZSwgZGF0ZXRpbWUsIHJhbmRvbQ0KZnJvbSBiczQgaW1wb3J0IEJlYXV0aWZ1bFNvdXAgYXMgYnMNCg0KIy0tPiBDbGVhciBUZXJtaW5hbA0KZGVmIGNsZWFyKCk6DQogICAgaWYgImxpbnV4IiBpbiBzeXMucGxhdGZvcm0ubG93ZXIoKTpvcy5zeXN0ZW0oImNsZWFyIikNCiAgICBlbGlmICJ3aW4iIGluIHN5cy5wbGF0Zm9ybS5sb3dlcigpOm9zLnN5c3RlbSgiY2xzIikNCg0KIy0tPiBUYW5nZ2FsDQpza3JuZyA9IGRhdGV0aW1lLmRhdGV0aW1lLm5vdygpDQp0YWh1biwgYnVsYW4sIGhhcmkgPSBza3JuZy55ZWFyLCBza3JuZy5tb250aCwgc2tybmcuZGF5DQpidWxhbl9jZWsgPSBbIkphbnVhcmkiLCAiRmVicnVhcmkiLCAiTWFyZXQiLCAiQXByaWwiLCAiTWVpIiwgIkp1bmkiLCAiSnVsaSIsICJBZ3VzdHVzIiwgIlNlcHRlbWJlciIsICJPa3RvYmVyIiwgIk5vdmVtYmVyIiwgIkRlc2VtYmVyIl0NCnRhbmdnYWwgPSAoIiVzLSVzLSVzIiUoaGFyaSxidWxhbl9jZWtbYnVsYW4tMV0sdGFodW4pKQ0KDQojLS0+IFdha3R1IEphbGFubnlhIFByb2dyYW0NCmRlZiBzdGFydCgpOg0KICAgIGdsb2JhbCBNdWxhaV9KYWxhbg0KICAgIE11bGFpX0phbGFuID0gZGF0ZXRpbWUuZGF0ZXRpbWUubm93KCkNCmRlZiBmaW5pc2goKToNCiAgICBnbG9iYWwgQWtoaXJfSmFsYW4sIFRvdGFsX1dha3R1DQogICAgQWtoaXJfSmFsYW4gPSBkYXRldGltZS5kYXRldGltZS5ub3coKQ0KICAgIFRvdGFsX1dha3R1ID0gQWtoaXJfSmFsYW4gLSBNdWxhaV9KYWxhbg0KICAgIHRyeToNCiAgICAgICAgTWVuaXQgPSBzdHIoVG90YWxfV2FrdHUpLnNwbGl0KCc6JylbMV0NCiAgICAgICAgRGV0aWsgPSBzdHIoVG90YWxfV2FrdHUpLnNwbGl0KCc6JylbMl0ucmVwbGFjZSgnLicsJywnKS5zcGxpdCgnLCcpWzBdICsgJywnICsgc3RyKFRvdGFsX1dha3R1KS5zcGxpdCgnOicpWzJdLnJlcGxhY2UoJy4nLCcsJykuc3BsaXQoJywnKVsxXVs6MV0NCiAgICAgICAgcHJpbnQoJ1xuUHJvZ3JhbSBTZWxlc2FpIERhbGFtIFdha3R1ICVzIE1lbml0ICVzIERldGlrXG4nJShNZW5pdCxEZXRpaykpDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICBwcmludCgnXG5Qcm9ncmFtIFNlbGVzYWkgRGFsYW0gV2FrdHUgMCBEZXRpa1xuJykNCg0KIy0tPiBBbmltYXNpDQpkZWYgYW5pbWFzaSgpOg0KICAgIHByaW50KCdcclNlZGFuZyBEdW1wICVzIElEJyUoc3RyKGxlbihkdW1wKSkpLGVuZD0nJyk7IHN5cy5zdGRvdXQuZmx1c2goKQ0KDQojLS0+IEdsb2JhbCBWYXJpYWJsZQ0KcGVtaXNhaCA9ICd8Jw0KDQojLS0+IFViYWggQmFoYXNhDQpkZWYgbGFuZ3VhZ2UoY29va2llKToNCiAgICB0cnk6DQogICAgICAgIHdpdGggcmVxdWVzdHMuU2Vzc2lvbigpIGFzIHh5ejoNCiAgICAgICAgICAgIHJlcSA9IHh5ei5nZXQoJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9sYW5ndWFnZS8nLGNvb2tpZXM9Y29va2llKQ0KICAgICAgICAgICAgcHJhID0gYnMocmVxLmNvbnRlbnQsJ2h0bWwucGFyc2VyJykNCiAgICAgICAgICAgIGZvciB4IGluIHByYS5maW5kX2FsbCgnZm9ybScseydtZXRob2QnOidwb3N0J30pOg0KICAgICAgICAgICAgICAgIGlmICdCYWhhc2EgSW5kb25lc2lhJyBpbiBzdHIoeCk6DQogICAgICAgICAgICAgICAgICAgIGJhaGFzYSA9IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICJmYl9kdHNnIiA6IHJlLnNlYXJjaCgnbmFtZT0iZmJfZHRzZyIgdmFsdWU9IiguKj8pIicsc3RyKHJlcS50ZXh0KSkuZ3JvdXAoMSksDQogICAgICAgICAgICAgICAgICAgICAgICAiamF6b2VzdCIgOiByZS5zZWFyY2goJ25hbWU9Imphem9lc3QiIHZhbHVlPSIoLio/KSInLCBzdHIocmVxLnRleHQpKS5ncm91cCgxKSwNCiAgICAgICAgICAgICAgICAgICAgICAgICJzdWJtaXQiICA6ICJCYWhhc2EgSW5kb25lc2lhIn0NCiAgICAgICAgICAgICAgICAgICAgdXJsID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbScgKyB4WydhY3Rpb24nXQ0KICAgICAgICAgICAgICAgICAgICBleGVjID0geHl6LnBvc3QodXJsLGRhdGE9YmFoYXNhLGNvb2tpZXM9Y29va2llKQ0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpwYXNzDQoNCiMtLT4gQ29udmVydA0KZGVmIHVzZXJfdG9faWQodXNlcm5hbWUpOg0KICAgIHRyeToNCiAgICAgICAgcmVxID0gYnMocmVxdWVzdHMuU2Vzc2lvbigpLmdldCgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyVzJyUodXNlcm5hbWUpLCBjb29raWVzPXsnY29va2llJzpvcGVuKCdsb2dpbi9jb29raWUuanNvbicsJ3InKS5yZWFkKCl9KS5jb250ZW50LCAnaHRtbC5wYXJzZXInKQ0KICAgICAgICBrdXQgPSByZXEuZmluZCgnYScsc3RyaW5nPSdMYWlubnlhJykNCiAgICAgICAgaWQgPSBzdHIoa3V0WydocmVmJ10pLnNwbGl0KCc9JylbMV0uc3BsaXQoJyYnKVswXQ0KICAgICAgICAjIGlkID0gcmUuc2VhcmNoKCdvd25lcl9pZD0oLio/KSInLHN0cihrdXQpKS5ncm91cCgxKQ0KICAgICAgICByZXR1cm4oaWQpDQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOnJldHVybih1c2VybmFtZSkNCmRlZiBncm91cF90b19pZCh1c2VybmFtZSk6DQogICAgdHJ5Og0KICAgICAgICByZXEgPSBicyhyZXF1ZXN0cy5TZXNzaW9uKCkuZ2V0KCdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vZ3JvdXBzLyVzJyUodXNlcm5hbWUpLCBjb29raWVzPXsnY29va2llJzpvcGVuKCdsb2dpbi9jb29raWUuanNvbicsJ3InKS5yZWFkKCl9KS5jb250ZW50LCAnaHRtbC5wYXJzZXInKQ0KICAgICAgICBrdXQgPSByZXEuZmluZCgnYScsc3RyaW5nPSdMaWhhdCBQb3N0aW5nYW4gTGFpbm55YScpDQogICAgICAgIGlkID0gc3RyKGt1dFsnaHJlZiddKS5zcGxpdCgnPycpWzBdLnNwbGl0KCcvJylbMl0NCiAgICAgICAgcmV0dXJuKGlkKQ0KICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTpyZXR1cm4odXNlcm5hbWUpDQoNCiMtLT4gTG9nbw0KZGVmIGxvZ28oKToNCiAgICBwcmludCgnXDAzM1sxOzMxbeKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWkeKWiOKWiOKVl+KWkeKWkeKWkeKWiOKWiOKVl+KWiOKWiOKWiOKVl+KWkeKWkeKWkeKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKVl+KWkScpDQogICAgcHJpbnQoJ1wwMzNbMTszMm3ilojilojilZTilZDilZDilojilojilZfilojilojilZHilpHilpHilpHilojilojilZHilojilojilojilojilZfilpHilojilojilojilojilZHilojilojilZTilZDilZDilojilojilZcnKQ0KICAgIHByaW50KCdcMDMzWzE7MzNt4paI4paI4pWR4paR4paR4paI4paI4pWR4paI4paI4pWR4paR4paR4paR4paI4paI4pWR4paI4paI4pWU4paI4paI4paI4paI4pWU4paI4paI4pWR4paI4paI4paI4paI4paI4paI4pWU4pWdJykNCiAgICBwcmludCgnXDAzM1sxOzM0beKWiOKWiOKVkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKVkeKWkeKWkeKWkeKWiOKWiOKVkeKWiOKWiOKVkeKVmuKWiOKWiOKVlOKVneKWiOKWiOKVkeKWiOKWiOKVlOKVkOKVkOKVkOKVneKWkScpDQogICAgcHJpbnQoJ1wwMzNbMTszNW3ilojilojilojilojilojilojilZTilZ3ilZrilojilojilojilojilojilojilZTilZ3ilojilojilZHilpHilZrilZDilZ3ilpHilojilojilZHilojilojilZHilpHilpHilpHilpHilpEnKQ0KICAgIHByaW50KCdcMDMzWzE7MzZt4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4paR4pWa4pWQ4pWQ4pWQ4pWQ4pWQ4pWd4paR4pWa4pWQ4pWd4paR4paR4paR4paR4paR4pWa4pWQ4pWd4pWa4pWQ4pWd4paR4paR4paR4paR4paRJykNCg0KIy0tPiBMb2dpbg0KY2xhc3MgbG9naW46DQogICAgZGVmIF9faW5pdF9fKHNlbGYpOg0KICAgICAgICBzZWxmLnh5eiA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgICAgICBzZWxmLmNla19jb29raWVzKCkNCiAgICAgICAgbWFpbl9tZW51KCkNCiAgICBkZWYgY2VrX2Nvb2tpZXMoc2VsZik6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHNlbGYuY29va2llICAgICA9IHsnY29va2llJzpvcGVuKCdsb2dpbi9jb29raWUuanNvbicsJ3InKS5yZWFkKCl9DQogICAgICAgICAgICBzZWxmLnRva2VuX2VhYWcgPSBvcGVuKCdsb2dpbi90b2tlbl9lYWFnLmpzb24nLCdyJykucmVhZCgpDQogICAgICAgICAgICBzZWxmLnRva2VuX2VhYWIgPSBvcGVuKCdsb2dpbi90b2tlbl9lYWFiLmpzb24nLCdyJykucmVhZCgpDQogICAgICAgICAgICBzZWxmLnRva2VuX2VhYWogPSBvcGVuKCdsb2dpbi90b2tlbl9lYWFqLmpzb24nLCdyJykucmVhZCgpDQogICAgICAgICAgICBsYW5ndWFnZShzZWxmLmNvb2tpZSkNCiAgICAgICAgICAgIHJlcTEgPSBzZWxmLnh5ei5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lP2ZpZWxkcz1uYW1lLGlkJmFjY2Vzc190b2tlbj0lcyclKHNlbGYudG9rZW5fZWFhZyksY29va2llcz1zZWxmLmNvb2tpZSkuanNvbigpWyduYW1lJ10NCiAgICAgICAgICAgIHJlcTIgPSBzZWxmLnh5ei5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lL2ZyaWVuZHM/ZmllbGRzPXN1bW1hcnkmbGltaXQ9MCZhY2Nlc3NfdG9rZW49JXMnJShzZWxmLnRva2VuX2VhYWIpLGNvb2tpZXM9c2VsZi5jb29raWUpLmpzb24oKVsnc3VtbWFyeSddWyd0b3RhbF9jb3VudCddDQogICAgICAgICAgICByZXEzID0gc2VsZi54eXouZ2V0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9maWVsZHM9ZnJpZW5kcy5saW1pdCgwKS5maWVsZHMoaWQsbmFtZSxiaXJ0aGRheSkmYWNjZXNzX3Rva2VuPSVzJyUoc2VsZi50b2tlbl9lYWFqKSxjb29raWVzPXNlbGYuY29va2llKS5qc29uKClbJ2ZyaWVuZHMnXQ0KICAgICAgICAgICAgY2xlYXIoKQ0KICAgICAgICAgICAgbG9nbygpDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgIHNlbGYuaW5zZXJ0X2Nvb2tpZSgpDQogICAgZGVmIGluc2VydF9jb29raWUoc2VsZik6DQogICAgICAgIHByaW50KCdcbkNvb2tpZSBJbnZhbGlkIScpDQogICAgICAgIHRpbWUuc2xlZXAoMikNCiAgICAgICAgY2xlYXIoKQ0KICAgICAgICBsb2dvKCkNCiAgICAgICAgY2lrbyA9IGlucHV0KCdFTlRFUiBGUkVTSCBDT09LSUU6ICcpDQogICAgICAgIHNlbGYudG9rZW5fZWFhZyA9IHNlbGYuZ2VuZXJhdGVfdG9rZW5fZWFhZyhjaWtvKQ0KICAgICAgICBzZWxmLnRva2VuX2VhYWIgPSBzZWxmLmdlbmVyYXRlX3Rva2VuX2VhYWIoY2lrbykNCiAgICAgICAgc2VsZi50b2tlbl9lYWFqID0gc2VsZi5nZW5lcmF0ZV90b2tlbl9lYWFqKGNpa28pDQogICAgICAgIHRyeTpvcy5ta2RpcigibG9naW4iKQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICBvcGVuKCdsb2dpbi9jb29raWUuanNvbicsJ3cnKS53cml0ZShjaWtvKQ0KICAgICAgICBvcGVuKCdsb2dpbi90b2tlbl9lYWFnLmpzb24nLCd3Jykud3JpdGUoc2VsZi50b2tlbl9lYWFnKQ0KICAgICAgICBvcGVuKCdsb2dpbi90b2tlbl9lYWFiLmpzb24nLCd3Jykud3JpdGUoc2VsZi50b2tlbl9lYWFiKQ0KICAgICAgICBvcGVuKCdsb2dpbi90b2tlbl9lYWFqLmpzb24nLCd3Jykud3JpdGUoc2VsZi50b2tlbl9lYWFqKQ0KICAgICAgICBzZWxmLmNla19jb29raWVzKCkNCiAgICBkZWYgZ2VuZXJhdGVfdG9rZW5fZWFhZyhzZWxmLGNvayk6DQogICAgICAgIHVybCA9ICdodHRwczovL2J1c2luZXNzLmZhY2Vib29rLmNvbS9idXNpbmVzc19sb2NhdGlvbnMnDQogICAgICAgIHJlcSA9IHNlbGYueHl6LmdldCh1cmwsY29va2llcz17J2Nvb2tpZSc6Y29rfSkNCiAgICAgICAgdG9rID0gcmUuc2VhcmNoKCcoXFsiRUFBR1x3KyknLCByZXEudGV4dCkuZ3JvdXAoMSkucmVwbGFjZSgnWyInLCcnKQ0KICAgICAgICByZXR1cm4oc3RyKHRvaykpDQogICAgZGVmIGdlbmVyYXRlX3Rva2VuX2VhYWIoc2VsZixjb2spOg0KICAgICAgICB1cmwgPSAnaHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL2Fkc21hbmFnZXIvbWFuYWdlL2NhbXBhaWducycNCiAgICAgICAgcmVxID0gc2VsZi54eXouZ2V0KHVybCxjb29raWVzPXsnY29va2llJzpjb2t9KQ0KICAgICAgICBzZXQgPSByZS5zZWFyY2goJ2FjdD0oLio/KSZuYXZfc291cmNlJyxzdHIocmVxLmNvbnRlbnQpKS5ncm91cCgxKQ0KICAgICAgICBuZWsgPSAnJXM/YWN0PSVzJm5hdl9zb3VyY2U9bm9fcmVmZXJyZXInJSh1cmwsc2V0KQ0KICAgICAgICByb3EgPSBzZWxmLnh5ei5nZXQobmVrLGNvb2tpZXM9eydjb29raWUnOmNva30pDQogICAgICAgIHRvayA9IHJlLnNlYXJjaCgnYWNjZXNzVG9rZW49IiguKj8pIicsc3RyKHJvcS5jb250ZW50KSkuZ3JvdXAoMSkNCiAgICAgICAgcmV0dXJuKHN0cih0b2spKQ0KICAgIGRlZiBnZW5lcmF0ZV90b2tlbl9lYWFqKHNlbGYsY29rKToNCiAgICAgICAgc2VsZi5jb29raWUgPSB7J2Nvb2tpZSc6Y29rfQ0KICAgICAgICBhcGsgID0gJzY2MTU4Nzk2Mzk5NDgxNHxmZmUwN2NjODY0ZmQxZGM4ZmUzODYyMjlkY2I3YTA1ZScNCiAgICAgICAgZGF0YSA9IHsnYWNjZXNzX3Rva2VuJzogYXBrLCAnc2NvcGUnOiAnJ30NCiAgICAgICAgcmVxICA9IHNlbGYueHl6LnBvc3QoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL3YxNi4wL2RldmljZS9sb2dpbi8nLGRhdGE9ZGF0YSkuanNvbigpDQogICAgICAgIGNkICAgPSByZXFbJ2NvZGUnXQ0KICAgICAgICB1Y2QgID0gcmVxWyd1c2VyX2NvZGUnXQ0KICAgICAgICB1cmwgID0gJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL3YxNi4wL2RldmljZS9sb2dpbl9zdGF0dXM/bWV0aG9kPXBvc3QmY29kZT0lcyZhY2Nlc3NfdG9rZW49JXMnJShjZCxhcGspDQogICAgICAgIHJlcSAgPSBicyhzZWxmLnh5ei5nZXQoJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9kZXZpY2UnLGNvb2tpZXM9c2VsZi5jb29raWUpLmNvbnRlbnQsJ2h0bWwucGFyc2VyJykNCiAgICAgICAgcmFxICA9IHJlcS5maW5kKCdmb3JtJyx7J21ldGhvZCc6J3Bvc3QnfSkNCiAgICAgICAgZGF0ICA9IHsnamF6b2VzdCcgOiByZS5zZWFyY2goJ25hbWU9Imphem9lc3QiIHR5cGU9ImhpZGRlbiIgdmFsdWU9IiguKj8pIicsc3RyKHJhcSkpLmdyb3VwKDEpLCAnZmJfZHRzZycgOiByZS5zZWFyY2goJ25hbWU9ImZiX2R0c2ciIHR5cGU9ImhpZGRlbiIgdmFsdWU9IiguKj8pIicsc3RyKHJlcSkpLmdyb3VwKDEpLCAncXInIDogJzAnLCAndXNlcl9jb2RlJyA6IHVjZH0NCiAgICAgICAgcmVsICA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20nICsgcmFxWydhY3Rpb24nXQ0KICAgICAgICBwb3MgID0gYnMoc2VsZi54eXoucG9zdChyZWwsZGF0YT1kYXQsY29va2llcz1zZWxmLmNvb2tpZSkuY29udGVudCwnaHRtbC5wYXJzZXInKQ0KICAgICAgICBkYXQgID0ge30NCiAgICAgICAgcmFxICA9IHBvcy5maW5kKCdmb3JtJyx7J21ldGhvZCc6J3Bvc3QnfSkNCiAgICAgICAgZm9yIHggaW4gcmFxKCdpbnB1dCcseyd2YWx1ZSc6VHJ1ZX0pOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGlmIHhbJ25hbWUnXSA9PSAnX19DQU5DRUxfXycgOiBwYXNzDQogICAgICAgICAgICAgICAgZWxzZTogZGF0LnVwZGF0ZSh7eFsnbmFtZSddOnhbJ3ZhbHVlJ119KQ0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBwYXNzDQogICAgICAgIHJlbCA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20nICsgcmFxWydhY3Rpb24nXQ0KICAgICAgICBwb3MgPSBicyhzZWxmLnh5ei5wb3N0KHJlbCxkYXRhPWRhdCxjb29raWVzPXNlbGYuY29va2llKS5jb250ZW50LCdodG1sLnBhcnNlcicpDQogICAgICAgIHJlcSA9IHNlbGYueHl6LmdldCh1cmwsY29va2llcz1zZWxmLmNvb2tpZSkuanNvbigpDQogICAgICAgIHRvayA9IHJlcVsnYWNjZXNzX3Rva2VuJ10NCiAgICAgICAgcmV0dXJuKHN0cih0b2spKQ0KDQojLS0+IE1lbnUgVXRhbWENCmNsYXNzIG1haW5fbWVudToNCiAgICBkZWYgX19pbml0X18oc2VsZik6DQogICAgICAgIHNlbGYueHl6ICAgICAgICA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgICAgICBzZWxmLmNvb2tpZSAgICAgPSB7J2Nvb2tpZSc6b3BlbignbG9naW4vY29va2llLmpzb24nLCdyJykucmVhZCgpfQ0KICAgICAgICBzZWxmLnRva2VuX2VhYWcgPSBvcGVuKCdsb2dpbi90b2tlbl9lYWFnLmpzb24nLCdyJykucmVhZCgpDQogICAgICAgIHNlbGYudG9rZW5fZWFhYiA9IG9wZW4oJ2xvZ2luL3Rva2VuX2VhYWIuanNvbicsJ3InKS5yZWFkKCkNCiAgICAgICAgc2VsZi5kYXNib3IoKQ0KICAgICAgICBzZWxmLm1lbnUoKQ0KICAgICAgICBzZWxmLnBpbGloX21lbnUoKQ0KICAgIGRlZiBkYXNib3Ioc2VsZik6DQogICAgICAgIHEgPSAnICcqNg0KICAgICAgICB6ID0ge30NCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgcmVxID0gc2VsZi54eXouZ2V0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9maWVsZHM9bmFtZSxpZCZhY2Nlc3NfdG9rZW49JXMnJShzZWxmLnRva2VuX2VhYWcpLGNvb2tpZXM9c2VsZi5jb29raWUpLmpzb24oKQ0KICAgICAgICAgICAgaWYgbGVuKHJlcVsnbmFtZSddKSA+IDE4OiB6LnVwZGF0ZSh7J05hbWEnOnN0cihyZXFbJ25hbWUnXSlbOjE1XSsnLi4uJ30pDQogICAgICAgICAgICBlbHNlOiB6LnVwZGF0ZSh7J05hbWEnOnN0cihyZXFbJ25hbWUnXSlbOjE1XX0pDQogICAgICAgICAgICB6LnVwZGF0ZSh7J0lEJzpzdHIocmVxWydpZCddKX0pDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogbG9naW4oKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBibG4gICAgPSB7JzAxJzonSmFudWFyaScsICcwMic6J0ZlYnJ1YXJpJywgJzAzJzonTWFyZXQnLCAnMDQnOidBcHJpbCcsICcwNSc6J01laScsICcwNic6J0p1bmknLCAnMDcnOidKdWxpJywgJzA4JzonQWd1c3R1cycsICcwOSc6J1NlcHRlbWJlcicsICcxMCc6J09rdG9iZXInLCAnMTEnOidOb3ZlbWJlcicsICcxMic6J0Rlc2VtYmVyJ30NCiAgICAgICAgICAgIHQsbSxoICA9IFt4WydjcmVhdGVkX3RpbWUnXS5zcGxpdCgnVCcpWzBdIGZvciB4IGluIHNlbGYueHl6LmdldCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vbWUvYWxidW1zP2ZpZWxkcz1pZCxuYW1lLGNyZWF0ZWRfdGltZSZsaW1pdD0xMDAwJmFjY2Vzc190b2tlbj0lcyclKHNlbGYudG9rZW5fZWFhZyksY29va2llcz1zZWxmLmNvb2tpZSkuanNvbigpWydkYXRhJ10gaWYgeFsnbmFtZSddPT0nRm90byBQcm9maWwnXVswXS5zcGxpdCgnLScpDQogICAgICAgICAgICB6LnVwZGF0ZSh7J0J1YXQnOiclcyAlcyAlcyclKGgsYmxuW21dLHQpfSkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBwYXNzDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIGZyZW4gPSBzdHIoc2VsZi54eXouZ2V0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZS9mcmllbmRzP2ZpZWxkcz1zdW1tYXJ5JmxpbWl0PTAmYWNjZXNzX3Rva2VuPSVzJyUoc2VsZi50b2tlbl9lYWFiKSxjb29raWVzPXNlbGYuY29va2llKS5qc29uKClbJ3N1bW1hcnknXVsndG90YWxfY291bnQnXSkNCiAgICAgICAgICAgIHoudXBkYXRlKHsnVGVtYW4nOmZyZW59KQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IHBhc3MNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgZm9scyA9IHN0cihzZWxmLnh5ei5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lL3N1YnNjcmliZXJzP2xpbWl0PTAmYWNjZXNzX3Rva2VuPSVzJyUoc2VsZi50b2tlbl9lYWFnKSxjb29raWVzPXNlbGYuY29va2llKS5qc29uKClbJ3N1bW1hcnknXVsndG90YWxfY291bnQnXSkNCiAgICAgICAgICAgIHoudXBkYXRlKHsnRm9sbHMnOmZvbHN9KQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IHBhc3MNCiAgICAgICAgcHJpbnQoJyVz4pWt4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSA4pSAWyBXZWxjb21lIF3ilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDilIDila4nJShxKSkNCiAgICAgICAgZm9yIHgseSBpbiB6aXAoei5rZXlzKCksei52YWx1ZXMoKSk6DQogICAgICAgICAgICBwcmludCgnJXPilIIgICAgJXMlczogJXMlc+KUgiclKHEseCwnICcqKDYtbGVuKHgpKSx5LCcgJyooMjItbGVuKHkpKSkpDQogICAgICAgIHByaW50KCclc+KVsOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKUgOKVryclKHEpKQ0KICAgIGRlZiBtZW51KHNlbGYpOg0KICAgICAgICBjID0gJyAnKjANCiAgICAgICAgcHJpbnQoJ1xuJXMgIFsgQWNjb3VudCBdICAgICAgICBbIEdyb3VwIF0gICAgICAgIFsgUG9zdCBdXG4nJShjKSkNCiAgICAgICAgcHJpbnQoJyVzWzAxXSBGcmllbmRsaXN0ICAgIFsxNV0gTWVtYmVycyAgICAgWzE5XSBDb21tZW50JyUoYykpDQogICAgICAgIHByaW50KCclc1swMl0gRm9sbG93ZXJzICAgICBbMTZdIFRpbWVsaW5lICAgIFsyMF0gUmVhY3QnJShjKSkNCiAgICAgICAgcHJpbnQoJyVzWzAzXSBDb21tZW50ICAgICAgIFsxN10gQ29tbWVudCAgICBbMjFdIEJBQ0sgVE8gTUVOVSclKGMpKSANCiAgICAgICAgcHJpbnQoJyVzWzA0XSBSZWFjdCAgICAgICAgIFsxOF0gUmVhY3QnJShjKSkNCiAgICAgICAgcHJpbnQoJyVzWzA1XSBNZXNzYWdlJyUoYykpDQogICAgICAgIHByaW50KCclc1swNl0gTmFtZSclKGMpKQ0KICAgICAgICBwcmludCgnJXNbMDddIFRpbWVsaW5lJyUoYykpDQogICAgICAgIHByaW50KCclc1swOF0gSGFzaHRhZyclKGMpKQ0KICAgICAgICBwcmludCgnJXNbMDldIEVtYWlsJyUoYykpDQogICAgICAgIHByaW50KCclc1sxMF0gUGhvbmUnJShjKSkNCiAgICAgICAgcHJpbnQoJyVzWzExXSBVc2VybmFtZSclKGMpKQ0KICAgICAgICBwcmludCgnJXNbMTJdIElEIFJhbmRvbSclKGMpKQ0KICAgICAgICBwcmludCgnJXNbMTNdIFN1Z2dlc3Rpb24nJShjKSkNCiAgICAgICAgcHJpbnQoJyVzWzE0XSBGTCBEYXJpIEZMJyUoYykpDQogICAgZGVmIHBpbGloX21lbnUoc2VsZik6DQogICAgICAgIHhvID0gaW5wdXQoJ1xuUGlsaWggOiAnKQ0KICAgICAgICBwcmludCgnJykNCiAgICAgICAgaWYgeG8gaW4gICBbJzEnLCAnMDEnICwnYSddOiBkdW1wX2ZyaWVuZGxpc3QoKQ0KICAgICAgICBlbGlmIHhvIGluIFsnMicsICcwMicgLCdiJ106IGR1bXBfZm9sbG93ZXJzKCkNCiAgICAgICAgZWxpZiB4byBpbiBbJzMnLCAnMDMnICwnYyddOiBkdW1wX3JlYWN0X2NvbW1lbnQoJ0FfSycpDQogICAgICAgIGVsaWYgeG8gaW4gWyc0JywgJzA0JyAsJ2QnXTogZHVtcF9yZWFjdF9jb21tZW50KCdBX1InKQ0KICAgICAgICBlbGlmIHhvIGluIFsnNScsICcwNScgLCdlJ106IGR1bXBfb3duZXJfYWNjb3VudCgnUFMnKQ0KICAgICAgICBlbGlmIHhvIGluIFsnNicsICcwNicgLCdmJ106IGR1bXBfb3duZXJfYWNjb3VudCgnTk0nKQ0KICAgICAgICBlbGlmIHhvIGluIFsnNycsICcwNycgLCdnJ106IGR1bXBfb3duZXJfYWNjb3VudCgnVEwnKQ0KICAgICAgICBlbGlmIHhvIGluIFsnOCcsICcwOCcgLCdoJ106IGR1bXBfb3duZXJfYWNjb3VudCgnSFMnKQ0KICAgICAgICBlbGlmIHhvIGluIFsnOScsICcwMDknLCdpJ106IGR1bXBfcmFuZG9tKCdFTScpDQogICAgICAgIGVsaWYgeG8gaW4gWycxMCcsJzAxMCcsJ2onXTogZHVtcF9yYW5kb20oJ1BPJykNCiAgICAgICAgZWxpZiB4byBpbiBbJzExJywnMDExJywnayddOiBkdW1wX3JhbmRvbSgnVVMnKQ0KICAgICAgICBlbGlmIHhvIGluIFsnMTInLCcwMTInLCdsJ106IGR1bXBfcmFuZG9tKCdJRCcpDQogICAgICAgIGVsaWYgeG8gaW4gWycxMycsJzAxMycsJ20nXTogZHVtcF9vd25lcl9hY2NvdW50KCdTVScpDQogICAgICAgIGVsaWYgeG8gaW4gWycxNCcsJzAxNCcsJ24nXTogZHVtcF9mbF9mbCgpDQogICAgICAgIGVsaWYgeG8gaW4gWycxNScsJzAxNScsJ28nXTogZHVtcF9yZWFjdF9jb21tZW50KCdNQicpDQogICAgICAgIGVsaWYgeG8gaW4gWycxNicsJzAxNicsJ3AnXTogZHVtcF9yZWFjdF9jb21tZW50KCdUTCcpDQogICAgICAgIGVsaWYgeG8gaW4gWycxNycsJzAxNycsJ3EnXTogZHVtcF9yZWFjdF9jb21tZW50KCdHX0snKQ0KICAgICAgICBlbGlmIHhvIGluIFsnMTgnLCcwMTgnLCdyJ106IGR1bXBfcmVhY3RfY29tbWVudCgnR19SJykNCiAgICAgICAgZWxpZiB4byBpbiBbJzE5JywnMDE5JywncyddOiBkdW1wX3JlYWN0X2NvbW1lbnQoJ1BfSycpDQogICAgICAgIGVsaWYgeG8gaW4gWycyMCcsJzAyMCcsJ3QnXTogZHVtcF9yZWFjdF9jb21tZW50KCdQX1InKQ0KICAgICAgICBlbGlmIHhvIGluIFsnMjEnLCcwMjEnXTogb3Muc3lzdGVtKCdweXRob24gbGwtZW5jLnB5JykNCiAgICAgICAgc2ltcGFuX2ZpbGUoKQ0KDQojLS0+IER1bXAgRnJpZW5kbGlzdA0KY2xhc3MgZHVtcF9mcmllbmRsaXN0Og0KICAgIGRlZiBfX2luaXRfXyhzZWxmKToNCiAgICAgICAgZ2xvYmFsIGR1bXANCiAgICAgICAgZHVtcCA9IHNlbGYuZHVtcCA9IFtdDQogICAgICAgIHNlbGYuZmFpbCAgICAgICAgPSBbXQ0KICAgICAgICBzZWxmLnBpc2FoICAgICAgID0gcGVtaXNhaA0KICAgICAgICBzZWxmLnh5eiAgICAgICAgID0gcmVxdWVzdHMuU2Vzc2lvbigpDQogICAgICAgIHNlbGYuY29va2llICAgICAgPSB7J2Nvb2tpZSc6b3BlbignbG9naW4vY29va2llLmpzb24nLCdyJykucmVhZCgpfQ0KICAgICAgICBzZWxmLnRva2VuX2VhYWcgID0gb3BlbignbG9naW4vdG9rZW5fZWFhZy5qc29uJywncicpLnJlYWQoKQ0KICAgICAgICBzZWxmLnRva2VuX2VhYWIgID0gb3BlbignbG9naW4vdG9rZW5fZWFhYi5qc29uJywncicpLnJlYWQoKQ0KICAgICAgICBzZWxmLnRva2VuX2VhYWogID0gb3BlbignbG9naW4vdG9rZW5fZWFhai5qc29uJywncicpLnJlYWQoKQ0KICAgICAgICBzZWxmLm1haW4oKQ0KICAgIGRlZiBtYWluKHNlbGYpOg0KICAgICAgICBwcmludCgnTXVsdGlwbGUgSURzLCBTZXBhcmF0ZSBCeSAoLCknKQ0KICAgICAgICBwcmludCgnRXhhbXBsZSAxMDAwOS0tLS0tLS0tLS0tNjEsMTAwMDM3LS0tLS0tLS0tLS0tLS0sY29udCcpDQogICAgICAgIGlkID0gaW5wdXQoJ0VOVEVSIFBVQkxJQyAgSUQgOiAnKS5zcGxpdCgnLCcpDQogICAgICAgIHByaW50KCcnKQ0KICAgICAgICBmb3IgZiBpbiBpZDoNCiAgICAgICAgICAgIGlmIGYgPT0gJ21lJzogaW8gPSBmDQogICAgICAgICAgICBlbGlmIChyZS5maW5kYWxsKCJbYS16QS1aXSIsc3RyKGYpKSkgOiBpbyA9IHVzZXJfdG9faWQoZikNCiAgICAgICAgICAgIGVsc2UgOiBpbyA9IGYNCiAgICAgICAgICAgIHNlbGYuY2VrKGlvKQ0KICAgICAgICBwcmludCgnJykNCiAgICAgICAgZm9yIGQgaW4gc2VsZi5mYWlsOg0KICAgICAgICAgICAgdHJ5OiBpZC5yZW1vdmUoZCkNCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogY29udGludWUNCiAgICAgICAgZm9yIHMgaW4gaWQ6DQogICAgICAgICAgICBpZiBzID09ICdtZSc6IGlvID0gcw0KICAgICAgICAgICAgZWxpZiAocmUuZmluZGFsbCgiW2EtekEtWl0iLHN0cihzKSkpIDogaW8gPSB1c2VyX3RvX2lkKHMpDQogICAgICAgICAgICBlbHNlIDogaW8gPSBzDQogICAgICAgICAgICBzZWxmLnJlcXUoaW8pDQogICAgICAgIGlmIGxlbihzZWxmLmR1bXApID09IDA6IHByaW50KCdcckZBSUxFRCBUTyBEVU1QJykNCiAgICAgICAgZWxzZTogcHJpbnQoJ1xyU3VjY2Vzc2Z1bGx5IEdldCAlcyBJRCclKHN0cihsZW4oc2VsZi5kdW1wKSkpKQ0KICAgIGRlZiBjZWsoc2VsZixpZCk6DQogICAgICAgIHRyeTogDQogICAgICAgICAgICBuYW1hICA9IHN0cihzZWxmLnh5ei5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzP2ZpZWxkcz1uYW1lJmFjY2Vzc190b2tlbj0lcyclKGlkLHNlbGYudG9rZW5fZWFhZyksY29va2llcz1zZWxmLmNvb2tpZSkuanNvbigpWyduYW1lJ10pDQogICAgICAgICAgICB0ZW1hbiA9IHN0cihzZWxmLnh5ei5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzP2ZpZWxkcz1mcmllbmRzLmxpbWl0KDApLmZpZWxkcyhpZCxuYW1lLGJpcnRoZGF5KSZhY2Nlc3NfdG9rZW49JXMnJShpZCxzZWxmLnRva2VuX2VhYWopLGNvb2tpZXM9c2VsZi5jb29raWUpLmpzb24oKVsnZnJpZW5kcyddWydzdW1tYXJ5J11bJ3RvdGFsX2NvdW50J10pDQogICAgICAgICAgICBwcmludCgnIOKAoiAlcyAtLT4gJXMgRlJJRU5EUyclKG5hbWEsdGVtYW4pKQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICBwcmludCgnIOKAoiAlcyAtLT4gRVJST1IvUHJpdmF0ZSclKGlkKSkNCiAgICAgICAgICAgIHNlbGYuZmFpbC5hcHBlbmQoaWQpDQogICAgZGVmIHJlcXUoc2VsZixpZCk6DQogICAgICAgIHVybCA9ICdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcz9maWVsZHM9ZnJpZW5kcy5saW1pdCg1MDAwKS5maWVsZHMoaWQsbmFtZSxiaXJ0aGRheSkmYWNjZXNzX3Rva2VuPSVzJyUoaWQsc2VsZi50b2tlbl9lYWFqKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICByZXEgPSBzZWxmLnh5ei5nZXQodXJsLGNvb2tpZXM9c2VsZi5jb29raWUpLmpzb24oKQ0KICAgICAgICAgICAgZm9yIHkgaW4gcmVxWydmcmllbmRzJ11bJ2RhdGEnXToNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIGlkLCBuYW1hID0geVsnaWQnXSwgeVsnbmFtZSddDQogICAgICAgICAgICAgICAgICAgIGZvcm1hdCA9ICclcyVzJXMnJShpZCxzZWxmLnBpc2FoLG5hbWEpDQogICAgICAgICAgICAgICAgICAgIHNlbGYuZHVtcC5hcHBlbmQoZm9ybWF0KQ0KICAgICAgICAgICAgICAgICAgICBhbmltYXNpKCkNCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IHBhc3MNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBwYXNzDQoNCiMtLT4gRHVtcCBGb2xsb3dlcnMNCmNsYXNzIGR1bXBfZm9sbG93ZXJzOg0KICAgIGRlZiBfX2luaXRfXyhzZWxmKToNCiAgICAgICAgZ2xvYmFsIGR1bXANCiAgICAgICAgZHVtcCA9IHNlbGYuZHVtcCA9IFtdDQogICAgICAgIHNlbGYuZmFpbCAgICAgICAgPSBbXQ0KICAgICAgICBzZWxmLnBpc2FoICAgICAgID0gcGVtaXNhaA0KICAgICAgICBzZWxmLnh5eiAgICAgICAgID0gcmVxdWVzdHMuU2Vzc2lvbigpDQogICAgICAgIHNlbGYuY29va2llICAgICAgPSB7J2Nvb2tpZSc6b3BlbignbG9naW4vY29va2llLmpzb24nLCdyJykucmVhZCgpfQ0KICAgICAgICBzZWxmLnRva2VuX2VhYWcgID0gb3BlbignbG9naW4vdG9rZW5fZWFhZy5qc29uJywncicpLnJlYWQoKQ0KICAgICAgICBzZWxmLnRva2VuX2VhYWIgID0gb3BlbignbG9naW4vdG9rZW5fZWFhYi5qc29uJywncicpLnJlYWQoKQ0KICAgICAgICBzZWxmLm1haW4oKQ0KICAgIGRlZiBtYWluKHNlbGYpOg0KICAgICAgICBwcmludCgnTXVsdGlwbGUgSURzLCBTZXBhcmF0ZSBCeSAoLCknKQ0KICAgICAgICBpZCA9IGlucHV0KCdNYXN1a2thbiBJRCA6ICcpLnNwbGl0KCcsJykNCiAgICAgICAgcHJpbnQoJycpDQogICAgICAgIGZvciBmIGluIGlkOg0KICAgICAgICAgICAgaWYgZiA9PSAnbWUnOiBpbyA9IGYNCiAgICAgICAgICAgIGVsaWYgKHJlLmZpbmRhbGwoIlthLXpBLVpdIixzdHIoZikpKSA6IGlvID0gdXNlcl90b19pZChmKQ0KICAgICAgICAgICAgZWxzZSA6IGlvID0gZg0KICAgICAgICAgICAgc2VsZi5jZWsoaW8pDQogICAgICAgIHByaW50KCcnKQ0KICAgICAgICBmb3IgZCBpbiBzZWxmLmZhaWw6DQogICAgICAgICAgICB0cnk6IGlkLnJlbW92ZShkKQ0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBjb250aW51ZQ0KICAgICAgICBmb3IgcyBpbiBpZDoNCiAgICAgICAgICAgIGlmIHMgPT0gJ21lJzogaW8gPSBzDQogICAgICAgICAgICBlbGlmIChyZS5maW5kYWxsKCJbYS16QS1aXSIsc3RyKHMpKSkgOiBpbyA9IHVzZXJfdG9faWQocykNCiAgICAgICAgICAgIGVsc2UgOiBpbyA9IHMNCiAgICAgICAgICAgIHNlbGYucmVxdSgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvc3Vic2NyaWJlcnM/bGltaXQ9MTAwMCZhY2Nlc3NfdG9rZW49JXMnJShpbyxzZWxmLnRva2VuX2VhYWcpKQ0KICAgICAgICBpZiBsZW4oc2VsZi5kdW1wKSA9PSAwOiBwcmludCgnXHJEdW1wIElEIEZBSUxFRCAnKQ0KICAgICAgICBlbHNlOiBwcmludCgnXHJTdWNjZXNzZnVsbHkgR2V0JXMgSUQnJShzdHIobGVuKHNlbGYuZHVtcCkpKSkNCiAgICBkZWYgY2VrKHNlbGYsaWQpOg0KICAgICAgICB0cnk6IA0KICAgICAgICAgICAgbmFtYSAgPSBzdHIoc2VsZi54eXouZ2V0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcz9maWVsZHM9bmFtZSZhY2Nlc3NfdG9rZW49JXMnJShpZCxzZWxmLnRva2VuX2VhYWcpLGNvb2tpZXM9c2VsZi5jb29raWUpLmpzb24oKVsnbmFtZSddKQ0KICAgICAgICAgICAgZm9sbHMgPSBzdHIoc2VsZi54eXouZ2V0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcy9zdWJzY3JpYmVycz9saW1pdD0wJmFjY2Vzc190b2tlbj0lcyclKGlkLHNlbGYudG9rZW5fZWFhZyksY29va2llcz1zZWxmLmNvb2tpZSkuanNvbigpWydzdW1tYXJ5J11bJ3RvdGFsX2NvdW50J10pDQogICAgICAgICAgICBwcmludCgnIOKAoiAlcyAtLT4gJXMgRm9sbHMnJShuYW1hLGZvbGxzKSkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgcHJpbnQoJyDigKIgJXMgLS0+IEtlc2FsYWhhbi9Qcml2YXRlJyUoaWQpKQ0KICAgICAgICAgICAgc2VsZi5mYWlsLmFwcGVuZChpZCkNCiAgICBkZWYgcmVxdShzZWxmLHVybCk6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHJlcSA9IHNlbGYueHl6LmdldCh1cmwsY29va2llcz1zZWxmLmNvb2tpZSkuanNvbigpDQogICAgICAgICAgICBmb3IgeSBpbiByZXFbJ2RhdGEnXToNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIGlkLCBuYW1hID0geVsnaWQnXSwgeVsnbmFtZSddDQogICAgICAgICAgICAgICAgICAgIGZvcm1hdCA9ICclcyVzJXMnJShpZCxzZWxmLnBpc2FoLG5hbWEpDQogICAgICAgICAgICAgICAgICAgIHNlbGYuZHVtcC5hcHBlbmQoZm9ybWF0KQ0KICAgICAgICAgICAgICAgICAgICBhbmltYXNpKCkNCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IHBhc3MNCiAgICAgICAgICAgIHNlbGYucmVxdShyZXFbJ3BhZ2luZyddWyduZXh0J10pDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogcGFzcw0KDQojLS0+IER1bXAgRnJpZW5kbGlzdCBEYXJpIEZyaWVuZGxpc3QNCmNsYXNzIGR1bXBfZmxfZmw6DQogICAgZGVmIF9faW5pdF9fKHNlbGYpOg0KICAgICAgICBnbG9iYWwgZHVtcA0KICAgICAgICBkdW1wID0gc2VsZi5kdW1wID0gW10NCiAgICAgICAgc2VsZi5mYWlsICAgICAgICA9IFtdDQogICAgICAgIHNlbGYucGlzYWggICAgICAgPSBwZW1pc2FoDQogICAgICAgIHNlbGYueHl6ICAgICAgICAgPSByZXF1ZXN0cy5TZXNzaW9uKCkNCiAgICAgICAgc2VsZi5jb29raWUgICAgICA9IHsnY29va2llJzpvcGVuKCdsb2dpbi9jb29raWUuanNvbicsJ3InKS5yZWFkKCl9DQogICAgICAgIHNlbGYudG9rZW5fZWFhZyAgPSBvcGVuKCdsb2dpbi90b2tlbl9lYWFnLmpzb24nLCdyJykucmVhZCgpDQogICAgICAgIHNlbGYudG9rZW5fZWFhYiAgPSBvcGVuKCdsb2dpbi90b2tlbl9lYWFiLmpzb24nLCdyJykucmVhZCgpDQogICAgICAgIHNlbGYubWFpbigpDQogICAgZGVmIG1haW4oc2VsZik6DQogICAgICAgIHByaW50KCdNdWx0aXBsZSBJRHMsIFNlcGFyYXRlIEJ5ICgsKScpDQogICAgICAgIGlkID0gaW5wdXQoJ0VOVEVSIFBVQkxJQyBJRCA6ICcpLnNwbGl0KCcsJykNCiAgICAgICAgcHJpbnQoJycpDQogICAgICAgIGZvciBmIGluIGlkOg0KICAgICAgICAgICAgaWYgZiA9PSAnbWUnOiBpbyA9IGYNCiAgICAgICAgICAgIGVsaWYgKHJlLmZpbmRhbGwoIlthLXpBLVpdIixzdHIoZikpKSA6IGlvID0gdXNlcl90b19pZChmKQ0KICAgICAgICAgICAgZWxzZSA6IGlvID0gZg0KICAgICAgICAgICAgc2VsZi5jZWsoaW8pDQogICAgICAgIHByaW50KCcnKQ0KICAgICAgICBmb3IgZCBpbiBzZWxmLmZhaWw6DQogICAgICAgICAgICB0cnk6IGlkLnJlbW92ZShkKQ0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBjb250aW51ZQ0KICAgICAgICBzZWxmLnQxID0gaW5wdXQoJ1NlbGVjdCBPbGQvWW91bmcgSUQgW3QvbV06ICcpLmxvd2VyKCkNCiAgICAgICAgc2VsZi50MiA9IGlucHV0KCdIb3cgbWFueSBJRHMgUGVyIEVhY2ggIkFjY291bnQgOiAnKQ0KICAgICAgICBwcmludCgnJykNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgZm9yIHMgaW4gaWQ6DQogICAgICAgICAgICAgICAgaWYgcyA9PSAnbWUnOiBpbyA9IHMNCiAgICAgICAgICAgICAgICBlbGlmIChyZS5maW5kYWxsKCJbYS16QS1aXSIsc3RyKHMpKSkgOiBpbyA9IHVzZXJfdG9faWQocykNCiAgICAgICAgICAgICAgICBlbHNlIDogaW8gPSBzDQogICAgICAgICAgICAgICAgbGlkID0gc2VsZi5yZXF1KGlvLCcxJykNCiAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICBmb3IgaCBpbiBsaWQ6DQogICAgICAgICAgICAgICAgICAgIHNlbGYucmVxdShoLnNwbGl0KHNlbGYucGlzYWgpWzBdLCcyJykNCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgICAgICBwYXNzDQogICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDogcGFzcw0KICAgICAgICBpZiBsZW4oc2VsZi5kdW1wKSA9PSAwOiBwcmludCgnXHJEdW1wIElEIEZBSUxFRCAnKQ0KICAgICAgICBlbHNlOiBwcmludCgnXHJTdWNjZXNzZnVsbHkgR2V0JXMgSUQnJShzdHIobGVuKHNlbGYuZHVtcCkpKSkNCiAgICBkZWYgY2VrKHNlbGYsaWQpOg0KICAgICAgICB0cnk6IA0KICAgICAgICAgICAgbmFtYSAgPSBzdHIoc2VsZi54eXouZ2V0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcz9maWVsZHM9bmFtZSZhY2Nlc3NfdG9rZW49JXMnJShpZCxzZWxmLnRva2VuX2VhYWcpLGNvb2tpZXM9c2VsZi5jb29raWUpLmpzb24oKVsnbmFtZSddKQ0KICAgICAgICAgICAgdGVtYW4gPSBzdHIoc2VsZi54eXouZ2V0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcy9mcmllbmRzP2ZpZWxkcz1zdW1tYXJ5JmxpbWl0PTAmYWNjZXNzX3Rva2VuPSVzJyUoaWQsc2VsZi50b2tlbl9lYWFiKSxjb29raWVzPXNlbGYuY29va2llKS5qc29uKClbJ3N1bW1hcnknXVsndG90YWxfY291bnQnXSkNCiAgICAgICAgICAgIHByaW50KCcg4oCiICVzIC0tPiAlcyBmcmllbmRzJyUobmFtYSx0ZW1hbikpDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToNCiAgICAgICAgICAgIHByaW50KCcg4oCiICVzIC0tPiBFUlJPUi9Qcml2YXRlJyUoaWQpKQ0KICAgICAgICAgICAgc2VsZi5mYWlsLmFwcGVuZChpZCkNCiAgICBkZWYgcmVxdShzZWxmLGlkLHRwKToNCiAgICAgICAgdXJsID0gJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzL2ZyaWVuZHM/ZmllbGRzPWlkLG5hbWUmbGltaXQ9NTAwMCZhY2Nlc3NfdG9rZW49JXMnJShpZCxzZWxmLnRva2VuX2VhYWIpDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHJlcSA9IHNlbGYueHl6LmdldCh1cmwsY29va2llcz1zZWxmLmNvb2tpZSkuanNvbigpDQogICAgICAgICAgICBwZW4gPSBbICclcyVzJXMnJSh5WydpZCddLHNlbGYucGlzYWgseVsnbmFtZSddKSBmb3IgeSBpbiByZXFbJ2RhdGEnXV0NCiAgICAgICAgICAgIHNtXyA9IFtdDQogICAgICAgICAgICBzbSAgPSBbXQ0KICAgICAgICAgICAgaWYgc2VsZi50MSBpbiBbJzEnLCcwMScsJ3QnLCd0dWEnXToNCiAgICAgICAgICAgICAgICBmb3IgeiBpbiBwZW46DQogICAgICAgICAgICAgICAgICAgIHNtLmFwcGVuZCh6KQ0KICAgICAgICAgICAgICAgICAgICBpZiBsZW4oc20pID09IGludChzZWxmLnQyKTogYnJlYWsNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgZm9yIHogaW4gcGVuOg0KICAgICAgICAgICAgICAgICAgICBzbV8uaW5zZXJ0KDAseikNCiAgICAgICAgICAgICAgICBmb3Igel8gaW4gc21fOg0KICAgICAgICAgICAgICAgICAgICBzbS5hcHBlbmQoel8pDQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihzbSkgPT0gaW50KHNlbGYudDIpOiBicmVhaw0KICAgICAgICAgICAgICAgIGlmIHRwID09ICcxJzoNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuKHNtKQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIGZvciBoIGluIHNtOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgaCBpbiBzZWxmLmR1bXA6cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTpzZWxmLmR1bXAuYXBwZW5kKGgpDQogICAgICAgICAgICAgICAgICAgICAgICBhbmltYXNpKCkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBwYXNzDQoNCiMtLT4gRHVtcCBSZWFjdCwgQ29tbWVudCwgTWVtYmVyLCBQaG90bywgVGltZWxpbmUNCmNsYXNzIGR1bXBfcmVhY3RfY29tbWVudDoNCg0KICAgICMtLT4gUGVuYW1wdW5nYW4gQXdhbA0KICAgIGRlZiBfX2luaXRfXyhzZWxmLHRwKToNCiAgICAgICAgZ2xvYmFsIGR1bXANCiAgICAgICAgZHVtcCA9IHNlbGYuZHVtcCA9IFtdDQogICAgICAgIHNlbGYuZmFpbCAgICAgICAgPSBbXQ0KICAgICAgICBzZWxmLnBpc2FoICAgICAgID0gcGVtaXNhaA0KICAgICAgICBzZWxmLmxpbWl0ICAgICAgID0gJzEwMCcNCiAgICAgICAgc2VsZi54eXogICAgICAgICA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgICAgICBzZWxmLmNvb2tpZSAgICAgID0geydjb29raWUnOm9wZW4oJ2xvZ2luL2Nvb2tpZS5qc29uJywncicpLnJlYWQoKX0NCiAgICAgICAgc2VsZi50b2tlbl9lYWFnICA9IG9wZW4oJ2xvZ2luL3Rva2VuX2VhYWcuanNvbicsJ3InKS5yZWFkKCkNCiAgICAgICAgc2VsZi50b2tlbl9lYWFiICA9IG9wZW4oJ2xvZ2luL3Rva2VuX2VhYWIuanNvbicsJ3InKS5yZWFkKCkNCiAgICAgICAgaWYgdHAgICA9PSAnQV9LJzogc2VsZi5tb2R1bCA9ICdLJzsgc2VsZi5tYWluX0EoKSAjLS0+IER1bXAgQ29tbWVudCBBY2NvdW50DQogICAgICAgIGVsaWYgdHAgPT0gJ0FfUic6IHNlbGYubW9kdWwgPSAnUic7IHNlbGYubWFpbl9BKCkgIy0tPiBEdW1wIFJlYWN0IEFjY291bnQNCiAgICAgICAgZWxpZiB0cCA9PSAnR19LJzogc2VsZi5tb2R1bCA9ICdLJzsgc2VsZi5tYWluX0coKSAjLS0+IER1bXAgQ29tbWVudCBHcm91cA0KICAgICAgICBlbGlmIHRwID09ICdHX1InOiBzZWxmLm1vZHVsID0gJ1InOyBzZWxmLm1haW5fRygpICMtLT4gRHVtcCBSZWFjdCBHcm91cA0KICAgICAgICBlbGlmIHRwID09ICdQX0snOiBzZWxmLm1vZHVsID0gJ0snOyBzZWxmLm1haW5fUCgpICMtLT4gRHVtcCBDb21tZW50IFBvc3QNCiAgICAgICAgZWxpZiB0cCA9PSAnUF9SJzogc2VsZi5tb2R1bCA9ICdSJzsgc2VsZi5tYWluX1AoKSAjLS0+IER1bXAgUmVhY3QgUG9zdA0KICAgICAgICBlbGlmIHRwID09ICdUTCcgOiBzZWxmLm1vZHVsID0gJ1QnOyBzZWxmLm1haW5fdGxfbWIoKSAjLS0+IER1bXAgVGltZWxpbmUNCiAgICAgICAgZWxpZiB0cCA9PSAnTUInIDogc2VsZi5tb2R1bCA9ICdNJzsgc2VsZi5tYWluX3RsX21iKCkgIy0tPiBEdW1wIE1lbWJlcg0KICAgIA0KICAgICMtLT4gRHVtcCBQb3N0IEFjY291bnQNCiAgICBkZWYgbWFpbl9BKHNlbGYpOg0KICAgICAgICBwcmludCgnTXVsdGlwbGUgSURzLCBTZXBhcmF0ZSBCeSAoLCknKQ0KICAgICAgICBpZCA9IGlucHV0KCdNYXN1a2thbiBJRCA6ICcpLnNwbGl0KCcsJykNCiAgICAgICAgcHJpbnQoJycpDQogICAgICAgIGZvciBmIGluIGlkOg0KICAgICAgICAgICAgaWYgZiA9PSAnbWUnOiBpbyA9IGYNCiAgICAgICAgICAgIGVsaWYgKHJlLmZpbmRhbGwoIlthLXpBLVpdIixzdHIoZikpKSA6IGlvID0gdXNlcl90b19pZChmKQ0KICAgICAgICAgICAgZWxzZSA6IGlvID0gZg0KICAgICAgICAgICAgc2VsZi5jZWtfQShpbykNCiAgICAgICAgcHJpbnQoJycpDQogICAgICAgIHByaW50KCdUZWthbiBjdHJsK2MgVW50dWsgQmVyaGVudGknKQ0KICAgICAgICBmb3IgZCBpbiBzZWxmLmZhaWw6DQogICAgICAgICAgICB0cnk6IGlkLnJlbW92ZShkKQ0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBjb250aW51ZQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBmb3IgcyBpbiBpZDoNCiAgICAgICAgICAgICAgICBpZiBzID09ICdtZSc6IGlvID0gcw0KICAgICAgICAgICAgICAgIGVsaWYgKHJlLmZpbmRhbGwoIlthLXpBLVpdIixzdHIocykpKSA6IGlvID0gdXNlcl90b19pZChzKQ0KICAgICAgICAgICAgICAgIGVsc2UgOiBpbyA9IHMNCiAgICAgICAgICAgICAgICBzZWxmLnJlcXUxX0EoaW8pDQogICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDogcGFzcw0KICAgICAgICBpZiBsZW4oc2VsZi5kdW1wKSA9PSAwOiBwcmludCgnXHJEdW1wIElEIEZBSUxFRCAnKQ0KICAgICAgICBlbHNlOiBwcmludCgnXHJTdWNjZXNzZnVsbHkgR2V0JXMgSUQnJShzdHIobGVuKHNlbGYuZHVtcCkpKSkNCiAgICBkZWYgY2VrX0Eoc2VsZixpZCk6DQogICAgICAgIHRyeTogDQogICAgICAgICAgICBuYW1hICA9IHN0cihzZWxmLnh5ei5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzP2ZpZWxkcz1uYW1lJmFjY2Vzc190b2tlbj0lcyclKGlkLHNlbGYudG9rZW5fZWFhZyksY29va2llcz1zZWxmLmNvb2tpZSkuanNvbigpWyduYW1lJ10pDQogICAgICAgICAgICBsaXN6ICA9IFt4WydpZCddIGZvciB4IGluIHNlbGYueHl6LmdldCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvcG9zdHM/ZmllbGRzPWlkJmxpbWl0PSVzJmFjY2Vzc190b2tlbj0lcyclKGlkLHNlbGYubGltaXQsc2VsZi50b2tlbl9lYWFnKSxjb29raWVzPXNlbGYuY29va2llKS5qc29uKClbJ2RhdGEnXV0NCiAgICAgICAgICAgIHBvc3QgID0gc3RyKGxlbihsaXN6KSkNCiAgICAgICAgICAgIHByaW50KCcg4oCiICVzIC0tPiAlcyBQb3N0JyUobmFtYSxwb3N0KSkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgcHJpbnQoJyDigKIgJXMgLS0+IEtlc2FsYWhhbi9Qcml2YXRlJyUoaWQpKQ0KICAgICAgICAgICAgc2VsZi5mYWlsLmFwcGVuZChpZCkNCiAgICBkZWYgcmVxdTFfQShzZWxmLGlkKToNCiAgICAgICAgbGlzeiAgPSBbeFsnaWQnXSBmb3IgeCBpbiBzZWxmLnh5ei5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzL3Bvc3RzP2ZpZWxkcz1pZCZsaW1pdD0lcyZhY2Nlc3NfdG9rZW49JXMnJShpZCxzZWxmLmxpbWl0LHNlbGYudG9rZW5fZWFhZyksY29va2llcz1zZWxmLmNvb2tpZSkuanNvbigpWydkYXRhJ11dDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIGZvciBwaWQgaW4gbGlzejoNCiAgICAgICAgICAgICAgICBpZiBzZWxmLm1vZHVsID09ICdLJzoNCiAgICAgICAgICAgICAgICAgICAgdXJsID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8nICsgcGlkDQogICAgICAgICAgICAgICAgICAgIHNlbGYubWFpbl9yZXF1X2NvbW1lbnQodXJsKQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIHNlbGYubWFpbl9yZXF1X3JlYWN0KHBpZCkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBwYXNzDQogICAgDQogICAgIy0tPiBEdW1wIFBvc3QgR3JvdXANCiAgICBkZWYgbWFpbl9HKHNlbGYpOg0KICAgICAgICBwcmludCgnTXVsdGlwbGUgSURzLCBTZXBhcmF0ZSBCeSAoLCknKQ0KICAgICAgICBpZCA9IGlucHV0KCdNYXN1a2thbiBJRCBHcnVwIDogJykuc3BsaXQoJywnKQ0KICAgICAgICBwcmludCgnJykNCiAgICAgICAgZm9yIGYgaW4gaWQ6DQogICAgICAgICAgICBpZiAocmUuZmluZGFsbCgiW2EtekEtWl0iLHN0cihmKSkpIDogaW8gPSBncm91cF90b19pZChmKQ0KICAgICAgICAgICAgZWxzZSA6IGlvID0gZg0KICAgICAgICAgICAgc2VsZi5jZWtfRyhpbykNCiAgICAgICAgcHJpbnQoJycpDQogICAgICAgIHByaW50KCdUZWthbiBjdHJsK2MgVW50dWsgQmVyaGVudGknKQ0KICAgICAgICBmb3IgZCBpbiBzZWxmLmZhaWw6DQogICAgICAgICAgICB0cnk6IGlkLnJlbW92ZShkKQ0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBjb250aW51ZQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBmb3IgcyBpbiBpZDoNCiAgICAgICAgICAgICAgICBpZiAocmUuZmluZGFsbCgiW2EtekEtWl0iLHN0cihzKSkpIDogaW8gPSBncm91cF90b19pZChzKQ0KICAgICAgICAgICAgICAgIGVsc2UgOiBpbyA9IHMNCiAgICAgICAgICAgICAgICBzZWxmLnJlcXUxX0coaW8pDQogICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDogcGFzcw0KICAgICAgICBpZiBsZW4oc2VsZi5kdW1wKSA9PSAwOiBwcmludCgnXHJEdW1wIElEIEZBSUxFRCAnKQ0KICAgICAgICBlbHNlOiBwcmludCgnXHJTdWNjZXNzZnVsbHkgR2V0JXMgSUQnJShzdHIobGVuKHNlbGYuZHVtcCkpKSkNCiAgICBkZWYgY2VrX0coc2VsZixpZCk6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHJlcSA9IHNlbGYueHl6LmdldCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXM/YWNjZXNzX3Rva2VuPSVzJyUoaWQsc2VsZi50b2tlbl9lYWFnKSxjb29raWVzPXNlbGYuY29va2llKS5qc29uKCkNCiAgICAgICAgICAgIGlmIHJlcVsncHJpdmFjeSddID09ICdPUEVOJzoNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIHJhcSA9IGJzKHNlbGYueHl6LmdldCgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2dyb3Vwcy8lcz92aWV3PWluZm8nJShpZCksY29va2llcz1zZWxmLmNvb2tpZSkuY29udGVudCwnaHRtbC5wYXJzZXInKQ0KICAgICAgICAgICAgICAgICAgICBhZ3QgPSBzdHIoW2MudGV4dCBmb3IgYyBpbiByYXEuZmluZF9hbGwoJ3RyJykgaWYgJ0FuZ2dvdGEnIGluIHN0cihjKV1bMF0ucmVwbGFjZSgnQW5nZ290YScsJycpKQ0KICAgICAgICAgICAgICAgICAgICBwb3MgPSBbeFsnaWQnXSBmb3IgeCBpbiBzZWxmLnh5ei5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzL2ZlZWQ/ZmllbGRzPWlkJmxpbWl0PSVzJmFjY2Vzc190b2tlbj0lcyclKGlkLHNlbGYubGltaXQsc2VsZi50b2tlbl9lYWFnKSxjb29raWVzPXNlbGYuY29va2llKS5qc29uKClbJ2RhdGEnXV0NCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IHBhc3MNCiAgICAgICAgICAgICAgICBwcmludCgnIOKAoiAlcyAtLT4gJXMgTWVtYmVycyAmICVzIFBvc3RzJyUoc3RyKHJlcVsnbmFtZSddKSxhZ3Qsc3RyKGxlbihwb3MpKSkpDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgIHByaW50KCcg4oCiICVzIC0tPiBLZXNhbGFoYW4vUHJpdmF0ZSclKGlkKSkNCiAgICAgICAgICAgICAgICBzZWxmLmZhaWwuYXBwZW5kKGlkKQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6DQogICAgICAgICAgICBwcmludCgnIOKAoiAlcyAtLT4gS2VzYWxhaGFuL1ByaXZhdGUnJShpZCkpDQogICAgICAgICAgICBzZWxmLmZhaWwuYXBwZW5kKGlkKQ0KICAgIGRlZiByZXF1MV9HKHNlbGYsaWQpOg0KICAgICAgICBsaXN6ICA9IFt4WydpZCddIGZvciB4IGluIHNlbGYueHl6LmdldCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvZmVlZD9maWVsZHM9aWQmbGltaXQ9JXMmYWNjZXNzX3Rva2VuPSVzJyUoaWQsc2VsZi5saW1pdCxzZWxmLnRva2VuX2VhYWcpLGNvb2tpZXM9c2VsZi5jb29raWUpLmpzb24oKVsnZGF0YSddXQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBmb3IgcGlkIGluIGxpc3o6DQogICAgICAgICAgICAgICAgaWYgc2VsZi5tb2R1bCA9PSAnSyc6DQogICAgICAgICAgICAgICAgICAgIHVybCA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vJyArIHBpZA0KICAgICAgICAgICAgICAgICAgICBzZWxmLm1haW5fcmVxdV9jb21tZW50KHVybCkNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBzZWxmLm1haW5fcmVxdV9yZWFjdChwaWQpDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogcGFzcw0KICAgIA0KICAgICMtLT4gRHVtcCBQb3N0DQogICAgZGVmIG1haW5fUChzZWxmKToNCiAgICAgICAgcHJpbnQoJ011bHRpcGxlIElEcywgU2VwYXJhdGUgQnkgKCwpJykNCiAgICAgICAgaWQgPSBpbnB1dCgnTWFzdWtrYW4gSUQgUG9zdCA6ICcpLnNwbGl0KCcsJykNCiAgICAgICAgcHJpbnQoJycpDQogICAgICAgIHByaW50KCdUZWthbiBjdHJsK2MgVW50dWsgQmVyaGVudGknKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBmb3IgcGlkIGluIGlkOg0KICAgICAgICAgICAgICAgIGlmIHNlbGYubW9kdWwgPT0gJ0snOg0KICAgICAgICAgICAgICAgICAgICB1cmwgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycgKyBwaWQNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYWluX3JlcXVfY29tbWVudCh1cmwpDQogICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYWluX3JlcXVfcmVhY3QocGlkKQ0KICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6IHBhc3MNCiAgICAgICAgaWYgbGVuKHNlbGYuZHVtcCkgPT0gMDogcHJpbnQoJ1xyRHVtcCBJRCBGQUlMRUQgJykNCiAgICAgICAgZWxzZTogcHJpbnQoJ1xyU3VjY2Vzc2Z1bGx5IEdldCVzIElEJyUoc3RyKGxlbihzZWxmLmR1bXApKSkpDQoNCiAgICAjLS0+IE1haW4gRHVtcCBDb21tZW50DQogICAgZGVmIG1haW5fcmVxdV9jb21tZW50KHNlbGYsdXJsKToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgcmVxID0gYnMoc2VsZi54eXouZ2V0KHVybCxjb29raWVzPXNlbGYuY29va2llKS5jb250ZW50LCdodG1sLnBhcnNlcicpDQogICAgICAgICAgICBmb3IgeCBpbiByZXEuZmluZF9hbGwoJ2gzJyk6DQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICB2ICAgID0geC5maW5kKCdhJyxocmVmPVRydWUpDQogICAgICAgICAgICAgICAgICAgIG5hbWEgPSB2LnRleHQNCiAgICAgICAgICAgICAgICAgICAgaWYgJ3Byb2ZpbGUucGhwJyBpbiB2WydocmVmJ106IGlkID0gcmUuc2VhcmNoKCdwcm9maWxlLnBocFw/aWRcPSguKj8pXCZhbXAnLHN0cih2KSkuZ3JvdXAoMSkNCiAgICAgICAgICAgICAgICAgICAgZWxzZTogaWQgPSB1c2VyX3RvX2lkKHZbJ2hyZWYnXS5zcGxpdCgnPycpWzBdLnJlcGxhY2UoJy8nLCcnKSkNCiAgICAgICAgICAgICAgICAgICAgZm9ybWF0ID0gJyVzJXMlcyclKGlkLHNlbGYucGlzYWgsbmFtYSkNCiAgICAgICAgICAgICAgICAgICAgaWYgZm9ybWF0IGluIHNlbGYuZHVtcDpwYXNzDQogICAgICAgICAgICAgICAgICAgIGVsc2U6c2VsZi5kdW1wLmFwcGVuZChmb3JtYXQpDQogICAgICAgICAgICAgICAgICAgIGFuaW1hc2koKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogY29udGludWUNCiAgICAgICAgICAgIG5layA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20nICsgcmVxLmZpbmQoJ2EnLHN0cmluZz0nIExpaGF0IGtvbWVudGFyIHNlYmVsdW1ueWHigKYnKVsnaHJlZiddDQogICAgICAgICAgICBzZWxmLm1haW5fcmVxdV9jb21tZW50KG5laykNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBwYXNzDQoNCiAgICAjLS0+IE1haW4gRHVtcCBSZWFjdA0KICAgIGRlZiBtYWluX3JlcXVfcmVhY3Qoc2VsZixpZCk6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHVybCA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vdWZpL3JlYWN0aW9uL3Byb2ZpbGUvYnJvd3Nlci8/ZnRfZW50X2lkZW50aWZpZXI9JyArIGlkLnNwbGl0KCdfJylbMV0NCiAgICAgICAgICAgIHJlcSA9IGJzKHNlbGYueHl6LmdldCh1cmwsY29va2llcz1zZWxmLmNvb2tpZSkuY29udGVudCwnaHRtbC5wYXJzZXInKQ0KICAgICAgICAgICAgZm9yIHkgaW4gcmVxLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgaWYgJy91ZmkvcmVhY3Rpb24vcHJvZmlsZS9icm93c2VyL2ZldGNoLz9mdF9lbnRfaWRlbnRpZmllcicgaW4geVsnaHJlZiddOg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ1NlbXVhJyBpbiB5LnRleHQ6IHBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJ3JlYWN0aW9uX3R5cGU9MCcgaW4gc3RyKHkpOiBwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxrMSA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20nICsgeVsnaHJlZiddLnJlcGxhY2UoJ2xpbWl0PTEwJywnbGltaXQ9NTAnKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuc2NyYXBfcmVhY3QobGsxKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogY29udGludWUNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBwYXNzDQogICAgZGVmIHNjcmFwX3JlYWN0KHNlbGYsdXJsKToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgcmVxID0gYnMoc2VsZi54eXouZ2V0KHVybCxjb29raWVzPXNlbGYuY29va2llKS5jb250ZW50LCdodG1sLnBhcnNlcicpDQogICAgICAgICAgICBmb3IgeiBpbiByZXEuZmluZF9hbGwoJ2gzJyk6DQogICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICB2ICAgID0gei5maW5kKCdhJyxocmVmPVRydWUpDQogICAgICAgICAgICAgICAgICAgIG5hbWEgPSB2LnRleHQNCiAgICAgICAgICAgICAgICAgICAgaWYgJ3Byb2ZpbGUucGhwJyBpbiB2WydocmVmJ106IGlkID0gcmUuc2VhcmNoKCdwcm9maWxlLnBocFw/aWRcPSguKj8pXCZhbXAnLHN0cih2KSkuZ3JvdXAoMSkNCiAgICAgICAgICAgICAgICAgICAgZWxzZTogaWQgPSB2WydocmVmJ10uc3BsaXQoJz8nKVswXS5yZXBsYWNlKCcvJywnJykNCiAgICAgICAgICAgICAgICAgICAgZm9ybWF0ID0gJyVzJXMlcyclKGlkLHNlbGYucGlzYWgsbmFtYSkNCiAgICAgICAgICAgICAgICAgICAgaWYgZm9ybWF0IGluIHNlbGYuZHVtcDpwYXNzDQogICAgICAgICAgICAgICAgICAgIGVsc2U6c2VsZi5kdW1wLmFwcGVuZChmb3JtYXQpDQogICAgICAgICAgICAgICAgICAgIGFuaW1hc2koKQ0KICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogY29udGludWUNCiAgICAgICAgICAgIG5layA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20nICsgcmVxLmZpbmQoJ2EnLHN0cmluZz0nTGloYXQgU2VsZW5na2FwbnlhJylbJ2hyZWYnXS5yZXBsYWNlKCdsaW1pdD0xMCcsJ2xpbWl0PTUwJykNCiAgICAgICAgICAgIHNlbGYuc2NyYXBfcmVhY3QobmVrKQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IHBhc3MNCg0KICAgICMtLT4gRHVtcCBUaW1lbGluZSAmIE1lbWJlciBHcm91cA0KICAgIGRlZiBtYWluX3RsX21iKHNlbGYpOg0KICAgICAgICBwcmludCgnTXVsdGlwbGUgSURzLCBTZXBhcmF0ZSBCeSAoLCknKQ0KICAgICAgICBpZCA9IGlucHV0KCdFTlRFUiBHUk9VUCBJRCA6ICcpLnNwbGl0KCcsJykNCiAgICAgICAgcHJpbnQoJycpDQogICAgICAgIGZvciBmIGluIGlkOg0KICAgICAgICAgICAgaWYgKHJlLmZpbmRhbGwoIlthLXpBLVpdIixzdHIoZikpKSA6IGlvID0gZ3JvdXBfdG9faWQoZikNCiAgICAgICAgICAgIGVsc2UgOiBpbyA9IGYNCiAgICAgICAgICAgIHNlbGYuY2VrX0coaW8pDQogICAgICAgIHByaW50KCcnKQ0KICAgICAgICBwcmludCgnVGVrYW4gY3RybCtjIFVudHVrIEJlcmhlbnRpJykNCiAgICAgICAgZm9yIGQgaW4gc2VsZi5mYWlsOg0KICAgICAgICAgICAgdHJ5OiBpZC5yZW1vdmUoZCkNCiAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogY29udGludWUNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgZm9yIHMgaW4gaWQ6DQogICAgICAgICAgICAgICAgaWYgKHJlLmZpbmRhbGwoIlthLXpBLVpdIixzdHIocykpKSA6IGlvID0gZ3JvdXBfdG9faWQocykNCiAgICAgICAgICAgICAgICBlbHNlIDogaW8gPSBzDQogICAgICAgICAgICAgICAgaWYgc2VsZi5tb2R1bCA9PSAnVCc6DQogICAgICAgICAgICAgICAgICAgIHNlbGYuc2NyYXBlX3RsKCdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vZ3JvdXBzLycraW8pDQogICAgICAgICAgICAgICAgZWxpZiBzZWxmLm1vZHVsID09ICdNJzoNCiAgICAgICAgICAgICAgICAgICAgc2VsZi5zY3JhcGVfbWIoJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9icm93c2UvZ3JvdXAvbWVtYmVycy8/aWQ9JXMmc3RhcnQ9MCclKGlvKSkNCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OiBwYXNzDQogICAgICAgIGlmIGxlbihzZWxmLmR1bXApID09IDA6IHByaW50KCdcckR1bXAgSUQgRkFJTEVEICcpDQogICAgICAgIGVsc2U6IHByaW50KCdcclN1Y2Nlc3NmdWxseSBHZXQlcyBJRCclKHN0cihsZW4oc2VsZi5kdW1wKSkpKQ0KICAgIA0KICAgICMtLT4gRHVtcCBUaW1lbGluZSBHcm91cA0KICAgIGRlZiBzY3JhcGVfdGwoc2VsZix1cmwpOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICByZXEgPSBicyhzZWxmLnh5ei5nZXQodXJsLGNvb2tpZXM9c2VsZi5jb29raWUpLmNvbnRlbnQsJ2h0bWwucGFyc2VyJykNCiAgICAgICAgICAgIGZvciB6IGluIHJlcS5maW5kX2FsbCgnaDMnKToNCiAgICAgICAgICAgICAgICBmb3IgcG8gaW4gei5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToNCiAgICAgICAgICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgJ21iYXNpYy5mYWNlYm9vay5jb20nIGluIHBvWydocmVmJ106cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiAnc3RvcnkucGhwJyBpbiBwb1snaHJlZiddOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJ0hhbGFtYW4nIGluIHBvLnRleHQ6cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiAncHJvZmlsZS5waHAnIGluIHBvWydocmVmJ106DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSByZS5maW5kYWxsKCdwcm9maWxlXC5waHBcP2lkPSguKj8pJicsc3RyKHBvWydocmVmJ10pKVswXQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5tID0gcG8udGV4dA0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCA9IHVzZXJfdG9faWQocmUuZmluZGFsbCgnXC8oLio/KVwvXD9yZWZpZCcsc3RyKHBvWydocmVmJ10pKVswXSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBubSA9IHBvLnRleHQNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdCA9ICclcyVzJXMnJShpZCxzZWxmLnBpc2FoLG5tKQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgZm9ybWF0IGluIHNlbGYuZHVtcDpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOnNlbGYuZHVtcC5hcHBlbmQoZm9ybWF0KQ0KICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWFzaSgpDQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogY29udGludWUNCiAgICAgICAgICAgIG5layA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20nICsgcmVxLmZpbmQoJ2EnLHN0cmluZz0nTGloYXQgUG9zdGluZ2FuIExhaW5ueWEnKVsnaHJlZiddDQogICAgICAgICAgICBzZWxmLnNjcmFwZV90bChuZWspDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogcGFzcw0KICAgIA0KICAgICMtLT4gRHVtcCBNZW1iZXIgR3JvdXANCiAgICBkZWYgc2NyYXBlX21iKHNlbGYsdXJsKToNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgcmVxID0gYnMoc2VsZi54eXouZ2V0KHVybCxjb29raWVzPXNlbGYuY29va2llKS5jb250ZW50LCdodG1sLnBhcnNlcicpDQogICAgICAgICAgICBmb3IgeiBpbiByZXEuZmluZF9hbGwoJ2gzJyk6DQogICAgICAgICAgICAgICAgZm9yIHBvIGluIHouZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICdhL2ZyaWVuZHMvYWRkJyBpbiBwb1snaHJlZiddOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJ3Byb2ZpbGUucGhwJyBpbiBwb1snaHJlZiddOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkID0gcmUuZmluZGFsbCgncHJvZmlsZVwucGhwXD9pZD0oLio/KSYnLHN0cihwb1snaHJlZiddKSlbMF0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBubSA9IHBvLnRleHQNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgPSB1c2VyX3RvX2lkKHJlLmZpbmRhbGwoJ1wvKC4qPylcL1w/cmVmaWQnLHN0cihwb1snaHJlZiddKSlbMF0pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbm0gPSBwby50ZXh0DQogICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQgPSAnJXMlcyVzJyUoaWQsc2VsZi5waXNhaCxubSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGZvcm1hdCBpbiBzZWxmLmR1bXA6cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZTpzZWxmLmR1bXAuYXBwZW5kKGZvcm1hdCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hc2koKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IGNvbnRpbnVlDQogICAgICAgICAgICBuZWsgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tJyArIHJlcS5maW5kKCdhJyxzdHJpbmc9J0xpaGF0IFNlbGVuZ2thcG55YScpWydocmVmJ10NCiAgICAgICAgICAgIHNlbGYuc2NyYXBlX21iKG5laykNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBwYXNzDQoNCiMtLT4gRHVtcCBNZXNzYWdlLCBOYW1lLCBUaW1lbGluZSwgSGFzaHRhZywgU3VnZ2VzdGlvbg0KY2xhc3MgZHVtcF9vd25lcl9hY2NvdW50Og0KICAgIA0KICAgICMtLT4gUGVuYW1wdW5nYW4gQXdhbA0KICAgIGRlZiBfX2luaXRfXyhzZWxmLHRwKToNCiAgICAgICAgZ2xvYmFsIGR1bXANCiAgICAgICAgZHVtcCA9IHNlbGYuZHVtcCA9IFtdDQogICAgICAgIHNlbGYuZmFpbCAgICAgICAgPSBbXQ0KICAgICAgICBzZWxmLnBpc2FoICAgICAgID0gcGVtaXNhaA0KICAgICAgICBzZWxmLnh5eiAgICAgICAgID0gcmVxdWVzdHMuU2Vzc2lvbigpDQogICAgICAgIHNlbGYuY29va2llICAgICAgPSB7J2Nvb2tpZSc6b3BlbignbG9naW4vY29va2llLmpzb24nLCdyJykucmVhZCgpfQ0KICAgICAgICBzZWxmLnRva2VuX2VhYWcgID0gb3BlbignbG9naW4vdG9rZW5fZWFhZy5qc29uJywncicpLnJlYWQoKQ0KICAgICAgICBzZWxmLnRva2VuX2VhYWIgID0gb3BlbignbG9naW4vdG9rZW5fZWFhYi5qc29uJywncicpLnJlYWQoKQ0KICAgICAgICBpZiB0cCAgID09ICdQUyc6IHNlbGYubWFpbl9tZXNzYWdlKCkgICAgIy0tPiBEdW1wIElEIEZyb20gTWVzc2FnZQ0KICAgICAgICBlbGlmIHRwID09ICdOTSc6IHNlbGYubWFpbl9uYW1lKCkgICAgICAgIy0tPiBEdW1wIElEIEZyb20gTmFtZQ0KICAgICAgICBlbGlmIHRwID09ICdUTCc6IHNlbGYubWFpbl90aW1lbGluZSgpICAgIy0tPiBEdW1wIElEIEZyb20gVGltZWxpbmUNCiAgICAgICAgZWxpZiB0cCA9PSAnSFMnOiBzZWxmLm1haW5faGFzaHRhZygpICAgICMtLT4gRHVtcCBJRCBGcm9tIEhhc2h0YWcNCiAgICAgICAgZWxpZiB0cCA9PSAnU1UnOiBzZWxmLm1haW5fc3VnZ2VzdGlvbigpICMtLT4gRHVtcCBJRCBGcm9tIFN1Z2dlc3Rpb24NCiAgICANCiAgICAjLS0+IER1bXAgSUQgRnJvbSBNZXNzYWdlDQogICAgZGVmIG1haW5fbWVzc2FnZShzZWxmKToNCiAgICAgICAgcHJpbnQoJ1Rla2FuIGN0cmwrYyBVbnR1ayBCZXJoZW50aScpDQogICAgICAgIHRyeTogc2VsZi5zY3JhcGVfbWVzc2FnZSgnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL21lc3NhZ2VzJykNCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OiBwYXNzDQogICAgICAgIGlmIGxlbihzZWxmLmR1bXApID09IDA6IHByaW50KCdcckR1bXAgSUQgRkFJTEVEICcpDQogICAgICAgIGVsc2U6IHByaW50KCdcclN1Y2Nlc3NmdWxseSBHZXQlcyBJRCclKHN0cihsZW4oc2VsZi5kdW1wKSkpKQ0KICAgIGRlZiBzY3JhcGVfbWVzc2FnZShzZWxmLHVybCk6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHJlcSA9IGJzKHNlbGYueHl6LmdldCh1cmwsY29va2llcz1zZWxmLmNvb2tpZSkuY29udGVudCwnaHRtbC5wYXJzZXInKQ0KICAgICAgICAgICAgZm9yIHAgaW4gcmVxLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIGlmICcvbWVzc2FnZXMvcmVhZC8/dGlkPWNpZC5jJyBpbiBwWydocmVmJ106DQogICAgICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIHAudGV4dCA9PSAnUGVuZ2d1bmEgRmFjZWJvb2snOiBjb250aW51ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCAgID0gc3RyKHJlLnNlYXJjaCgnJTNBKC4qPykmJyxwWydocmVmJ10pLmdyb3VwKDEpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWEgPSBwLnRleHQNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdCA9ICclcyVzJXMnJShpZCxzZWxmLnBpc2FoLG5hbWEpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBmb3JtYXQgaW4gc2VsZi5kdW1wOiBwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOiBzZWxmLmR1bXAuYXBwZW5kKGZvcm1hdCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hc2koKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IGNvbnRpbnVlDQogICAgICAgICAgICBuZWsgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tJyArIHJlcS5maW5kKCdhJyxzdHJpbmc9J0xpaGF0IFBlc2FuIFNlYmVsdW1ueWEnKVsnaHJlZiddDQogICAgICAgICAgICBzZWxmLnNjcmFwZV9tZXNzYWdlKG5laykNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBwYXNzDQoNCiAgICAjLS0+IER1bXAgSUQgRnJvbSBOYW1lDQogICAgZGVmIG1haW5fbmFtZShzZWxmKToNCiAgICAgICAgbGlkID0gW10NCiAgICAgICAgcHJpbnQoJ0JhbnlhayBOYW1hLCBQaXNhaGthbiBEZ24gKCwpJykNCiAgICAgICAgaWQgPSBpbnB1dCgnTWFzdWtrYW4gTmFtYSA6ICcpLmxvd2VyKCkuc3BsaXQoJywnKQ0KICAgICAgICBjb21tb24gPSBbJ2FuZGknLCdkd2knLCdtdWhhbW1hZCcsJ251cicsJ2Rld2knLCd0cmknLCdkaWFuJywnc3JpJywncHV0cmknLCdla2EnLCdzYXJpJywnYWRpdHlhJywnYmFzdWtpJywnYnVkaScsJ2pvbmknLCd0b25pJywnY2FoeWEnLCdyaXNraScsJ2ZhcmhhbicsJ2FkZW4nLCdqb2tvJ10NCiAgICAgICAgZm9yIHggaW4gaWQ6DQogICAgICAgICAgICBmb3IgeSBpbiBjb21tb246DQogICAgICAgICAgICAgICAgbGlkLmFwcGVuZCgnJXMgJXMnJSh4LHkpKQ0KICAgICAgICAgICAgICAgIGxpZC5hcHBlbmQoJyVzICVzJyUoeSx4KSkNCiAgICAgICAgcHJpbnQoJycpDQogICAgICAgIHByaW50KCdUZWthbiBjdHJsK2MgVW50dWsgQmVyaGVudGknKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBmb3IgeiBpbiBsaWQ6DQogICAgICAgICAgICAgICAgdXJsID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9zZWFyY2gvcGVvcGxlLz9xPScgKyB6DQogICAgICAgICAgICAgICAgc2VsZi5zY3JhcGVfbmFtZSh1cmwpDQogICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDogcGFzcw0KICAgICAgICBpZiBsZW4oc2VsZi5kdW1wKSA9PSAwOiBwcmludCgnXHJEdW1wIElEIEZBSUxFRCAnKQ0KICAgICAgICBlbHNlOiBwcmludCgnXHJTdWNjZXNzZnVsbHkgR2V0JXMgSUQnJShzdHIobGVuKHNlbGYuZHVtcCkpKSkNCiAgICBkZWYgc2NyYXBlX25hbWUoc2VsZix1cmwpOg0KICAgICAgICB0cnk6DQogICAgICAgICAgICByZXEgPSBicyhzZWxmLnh5ei5nZXQodXJsLGNvb2tpZXM9c2VsZi5jb29raWUpLmNvbnRlbnQsJ2h0bWwucGFyc2VyJykNCiAgICAgICAgICAgIGZvciBwIGluIHJlcS5maW5kX2FsbCgnYScsaHJlZj1UcnVlKToNCiAgICAgICAgICAgICAgICB0cnk6DQogICAgICAgICAgICAgICAgICAgIGlmICI8aW1nIGFsdD0iIGluIHN0cihwKToNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICJob21lLnBocCIgaW4gc3RyKHBbImhyZWYiXSk6IGNvbnRpbnVlDQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmICdwcm9maWxlLnBocCcgaW4gc3RyKHBbImhyZWYiXSk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWQgICA9IHJlLnNlYXJjaCgnIi9wcm9maWxlXC5waHBcP2lkPSguKj8pJiInLHN0cihwKSkuZ3JvdXAoMSkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1hID0gcC5maW5kKCJpbWciKVsnYWx0J10ucmVwbGFjZSgiLCBwcm9maWxlIHBpY3R1cmUiLCIiKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiAncmVmaWQnIGluIHN0cihwWyJocmVmIl0pOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkICAgPSB1c2VyX3RvX2lkKHJlLnNlYXJjaCgiLyguKj8pXD8iLHN0cihwKSkuZ3JvdXAoMSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtYSA9IHAuZmluZCgiaW1nIilbJ2FsdCddLnJlcGxhY2UoIiwgcHJvZmlsZSBwaWN0dXJlIiwiIikNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdCA9ICclcyVzJXMnJShpZCxzZWxmLnBpc2FoLG5hbWEpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBmb3JtYXQgaW4gc2VsZi5kdW1wOiBwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOiBzZWxmLmR1bXAuYXBwZW5kKGZvcm1hdCkNCiAgICAgICAgICAgICAgICAgICAgYW5pbWFzaSgpDQogICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBjb250aW51ZQ0KICAgICAgICAgICAgbmVrID0gcmVxLmZpbmQoJ2EnLHN0cmluZz0nTGloYXQgSGFzaWwgU2VsYW5qdXRueWEnKVsnaHJlZiddDQogICAgICAgICAgICBzZWxmLnNjcmFwZV9uYW1lKG5laykNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOiBwYXNzDQogICAgDQogICAgIy0tPiBEdW1wIElEIEZyb20gVGltZWxpbmUNCiAgICBkZWYgbWFpbl90aW1lbGluZShzZWxmKToNCiAgICAgICAgcHJpbnQoJ1Rla2FuIGN0cmwrYyBVbnR1ayBCZXJoZW50aScpDQogICAgICAgIHRyeTogc2VsZi5zY3JhcGVfdGltZWxpbmUoJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8nKQ0KICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6IHBhc3MNCiAgICAgICAgaWYgbGVuKHNlbGYuZHVtcCkgPT0gMDogcHJpbnQoJ1xyRHVtcCBJRCBGQUlMRUQgJykNCiAgICAgICAgZWxzZTogcHJpbnQoJ1xyU3VjY2Vzc2Z1bGx5IEdldCVzIElEJyUoc3RyKGxlbihzZWxmLmR1bXApKSkpDQogICAgZGVmIHNjcmFwZV90aW1lbGluZShzZWxmLHVybCk6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHJlcSA9IGJzKHNlbGYueHl6LmdldCh1cmwsY29va2llcz1zZWxmLmNvb2tpZSkuY29udGVudCwnaHRtbC5wYXJzZXInKQ0KICAgICAgICAgICAgZm9yIHEgaW4gcmVxLmZpbmRfYWxsKCdoMycpOg0KICAgICAgICAgICAgICAgIGZvciBwIGluIHEuZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICdtYmFzaWMuZmFjZWJvb2suY29tJyBpbiBwWydocmVmJ106cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiAnc3ViX3ZpZXcnIGluIHBbJ2hyZWYnXTpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmICcvPycgaW4gcFsnaHJlZiddOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJ3Byb2ZpbGUucGhwJyBpbiBzdHIocFsiaHJlZiJdKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCAgID0gc3RyKHJlLnNlYXJjaCgnXD9pZD0oLio/KSYnLHBbJ2hyZWYnXSkuZ3JvdXAoMSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtYSA9IHN0cihyZS5zZWFyY2goJz4oLio/KTxcL2E+JyxzdHIocCkpLmdyb3VwKDEpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCAgID0gdXNlcl90b19pZChzdHIocmUuc2VhcmNoKCdcLyguKj8pXD8nLHBbJ2hyZWYnXSkuZ3JvdXAoMSkpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWEgPSBzdHIocmUuc2VhcmNoKCc+KC4qPyk8XC9hPicsc3RyKHApKS5ncm91cCgxKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdCA9ICclcyVzJXMnJShpZCxzZWxmLnBpc2FoLG5hbWEpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBmb3JtYXQgaW4gc2VsZi5kdW1wOiBwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOiBzZWxmLmR1bXAuYXBwZW5kKGZvcm1hdCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hc2koKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IGNvbnRpbnVlDQogICAgICAgICAgICBuZWsgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tJyArIHJlcS5maW5kKCdhJyxzdHJpbmc9J0xpaGF0IEJlcml0YSBMYWluJylbJ2hyZWYnXQ0KICAgICAgICAgICAgc2VsZi5zY3JhcGVfdGltZWxpbmUobmVrKQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IHBhc3MNCg0KICAgICMtLT4gRHVtcCBJRCBGcm9tIEhhc2h0YWcNCiAgICBkZWYgbWFpbl9oYXNodGFnKHNlbGYpOg0KICAgICAgICBwcmludCgnQmFueWFrIEhhc2h0YWcsIFBpc2Foa2FuIERnbiAoLCknKQ0KICAgICAgICBpZCA9IGlucHV0KCdNYXN1a2thbiBIYXNodGFnIDogJykucmVwbGFjZSgnICcsJycpLnNwbGl0KCcsJykNCiAgICAgICAgcHJpbnQoJycpDQogICAgICAgIHByaW50KCdUZWthbiBjdHJsK2MgVW50dWsgQmVyaGVudGknKQ0KICAgICAgICB0cnk6DQogICAgICAgICAgICBmb3IgeiBpbiBpZDoNCiAgICAgICAgICAgICAgICB1cmwgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2hhc2h0YWcvJyArIHoNCiAgICAgICAgICAgICAgICBzZWxmLnNjcmFwZV9oYXNodGFnKHVybCkNCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OiBwYXNzDQogICAgICAgIGlmIGxlbihzZWxmLmR1bXApID09IDA6IHByaW50KCdcckR1bXAgSUQgRkFJTEVEICcpDQogICAgICAgIGVsc2U6IHByaW50KCdcclN1Y2Nlc3NmdWxseSBHZXQlcyBJRCclKHN0cihsZW4oc2VsZi5kdW1wKSkpKQ0KICAgIGRlZiBzY3JhcGVfaGFzaHRhZyhzZWxmLHVybCk6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHJlcSA9IGJzKHNlbGYueHl6LmdldCh1cmwsY29va2llcz1zZWxmLmNvb2tpZSkuY29udGVudCwnaHRtbC5wYXJzZXInKQ0KICAgICAgICAgICAgZm9yIHEgaW4gcmVxLmZpbmRfYWxsKCdoMycpOg0KICAgICAgICAgICAgICAgIGZvciBwIGluIHEuZmluZF9hbGwoJ2EnLGhyZWY9VHJ1ZSk6DQogICAgICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICdtYmFzaWMuZmFjZWJvb2suY29tJyBpbiBwWydocmVmJ106cGFzcw0KICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiAnc3ViX3ZpZXcnIGluIHBbJ2hyZWYnXTpwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbGlmICcvPycgaW4gcFsnaHJlZiddOnBhc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJ3Byb2ZpbGUucGhwJyBpbiBzdHIocFsiaHJlZiJdKToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCAgID0gc3RyKHJlLnNlYXJjaCgnXD9pZD0oLio/KSYnLHBbJ2hyZWYnXSkuZ3JvdXAoMSkpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmFtYSA9IHN0cihyZS5zZWFyY2goJz4oLio/KTxcL2E+JyxzdHIocCkpLmdyb3VwKDEpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZCAgID0gdXNlcl90b19pZChzdHIocmUuc2VhcmNoKCdcLyguKj8pXD8nLHBbJ2hyZWYnXSkuZ3JvdXAoMSkpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWEgPSBzdHIocmUuc2VhcmNoKCc+KC4qPyk8XC9hPicsc3RyKHApKS5ncm91cCgxKSkNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdCA9ICclcyVzJXMnJShpZCxzZWxmLnBpc2FoLG5hbWEpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiBmb3JtYXQgaW4gc2VsZi5kdW1wOiBwYXNzDQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOiBzZWxmLmR1bXAuYXBwZW5kKGZvcm1hdCkNCiAgICAgICAgICAgICAgICAgICAgICAgIGFuaW1hc2koKQ0KICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IGNvbnRpbnVlDQogICAgICAgICAgICBuZWsgPSByZXEuZmluZCgnYScsc3RyaW5nPSdMaWhhdCBIYXNpbCBTZWxhbmp1dG55YScpWydocmVmJ10NCiAgICAgICAgICAgIHNlbGYuc2NyYXBlX2hhc2h0YWcobmVrKQ0KICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IHBhc3MNCiAgICANCiAgICAjLS0+IER1bXAgSUQgRnJvbSBTdWdnZXN0aW9uDQogICAgZGVmIG1haW5fc3VnZ2VzdGlvbihzZWxmKToNCiAgICAgICAgcHJpbnQoJ1Rla2FuIGN0cmwrYyBVbnR1ayBCZXJoZW50aScpDQogICAgICAgIHRyeTogc2VsZi5zY3JhcGVfc3VnZ2VzdGlvbignaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2ZyaWVuZHMvY2VudGVyL3N1Z2dlc3Rpb25zJykNCiAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OiBwYXNzDQogICAgICAgIGlmIGxlbihzZWxmLmR1bXApID09IDA6IHByaW50KCdcckR1bXAgSUQgRkFJTEVEICcpDQogICAgICAgIGVsc2U6IHByaW50KCdcclN1Y2Nlc3NmdWxseSBHZXQlcyBJRCclKHN0cihsZW4oc2VsZi5kdW1wKSkpKQ0KICAgIGRlZiBzY3JhcGVfc3VnZ2VzdGlvbihzZWxmLHVybCk6DQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHJlcSA9IGJzKHNlbGYueHl6LmdldCh1cmwsY29va2llcz1zZWxmLmNvb2tpZSkuY29udGVudCwnaHRtbC5wYXJzZXInKQ0KICAgICAgICAgICAgZm9yIHAgaW4gcmVxLmZpbmRfYWxsKCdhJyxocmVmPVRydWUpOg0KICAgICAgICAgICAgICAgIHRyeToNCiAgICAgICAgICAgICAgICAgICAgaWYgImZyaWVuZHMvaG92ZXJjYXJkL21iYXNpYyIgaW4gc3RyKHBbJ2hyZWYnXSk6DQogICAgICAgICAgICAgICAgICAgICAgICBpZCAgID0gcFsnaHJlZiddLnNwbGl0KCcmJylbMF0uc3BsaXQoJz0nKVsxXQ0KICAgICAgICAgICAgICAgICAgICAgICAgbmFtYSA9IHAudGV4dA0KICAgICAgICAgICAgICAgICAgICBmb3JtYXQgPSAnJXMlcyVzJyUoaWQsc2VsZi5waXNhaCxuYW1hKQ0KICAgICAgICAgICAgICAgICAgICBpZiBmb3JtYXQgaW4gc2VsZi5kdW1wOiBwYXNzDQogICAgICAgICAgICAgICAgICAgIGVsc2U6IHNlbGYuZHVtcC5hcHBlbmQoZm9ybWF0KQ0KICAgICAgICAgICAgICAgICAgICBhbmltYXNpKCkNCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IHBhc3MNCiAgICAgICAgICAgIG5layA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20nICsgcmVxLmZpbmQoJ2EnLHN0cmluZz0nTGloYXQgc2VsZW5na2FwbnlhJylbJ2hyZWYnXQ0KICAgICAgICAgICAgc2VsZi5zY3JhcGVfc3VnZ2VzdGlvbihuZWspDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogcGFzcw0KDQojLS0+IER1bXAgUmFuZG9tIEVtYWlsLCBQaG9uZSwgVXNlcm5hbWUsIElEDQpjbGFzcyBkdW1wX3JhbmRvbToNCiAgICANCiAgICAjLS0+IFBlbmFtcHVuZ2FuIEF3YWwNCiAgICBkZWYgX19pbml0X18oc2VsZix0cCk6DQogICAgICAgIGdsb2JhbCBkdW1wDQogICAgICAgIGR1bXAgPSBzZWxmLmR1bXAgPSBbXQ0KICAgICAgICBzZWxmLmZhaWwgICAgICAgID0gW10NCiAgICAgICAgc2VsZi5waXNhaCAgICAgICA9IHBlbWlzYWgNCiAgICAgICAgc2VsZi54eXogICAgICAgICA9IHJlcXVlc3RzLlNlc3Npb24oKQ0KICAgICAgICBzZWxmLmNvb2tpZSAgICAgID0geydjb29raWUnOm9wZW4oJ2xvZ2luL2Nvb2tpZS5qc29uJywncicpLnJlYWQoKX0NCiAgICAgICAgc2VsZi50b2tlbl9lYWFnICA9IG9wZW4oJ2xvZ2luL3Rva2VuX2VhYWcuanNvbicsJ3InKS5yZWFkKCkNCiAgICAgICAgc2VsZi50b2tlbl9lYWFiICA9IG9wZW4oJ2xvZ2luL3Rva2VuX2VhYWIuanNvbicsJ3InKS5yZWFkKCkNCiAgICAgICAgaWYgdHAgICA9PSAnRU0nOiBzZWxmLm1haW5fZW1haWwoKSAgICAjLS0+IFJhbmRvbSBFbWFpbA0KICAgICAgICBlbGlmIHRwID09ICdQTyc6IHNlbGYubWFpbl9waG9uZSgpICAgICMtLT4gUmFuZG9tIFBob25lDQogICAgICAgIGVsaWYgdHAgPT0gJ1VTJzogc2VsZi5tYWluX3VzZXJuYW1lKCkgIy0tPiBSYW5kb20gVXNlcm5hbWUNCiAgICAgICAgZWxpZiB0cCA9PSAnSUQnOiBzZWxmLm1haW5faWQoKSAgICAgICAjLS0+IFJhbmRvbSBJRA0KICAgIA0KICAgICMtLT4gQXV0byBHZW5lcmF0ZSBSYW5kb20gRW1haWwNCiAgICBkZWYgbWFpbl9lbWFpbChzZWxmKToNCiAgICAgICAgYmVsdW1fYmlzYSgpDQoNCiAgICAjLS0+IEF1dG8gR2VuZXJhdGUgUmFuZG9tIFBob25lDQogICAgZGVmIG1haW5fcGhvbmUoc2VsZik6DQogICAgICAgIGJlbHVtX2Jpc2EoKQ0KDQogICAgIy0tPiBBdXRvIEdlbmVyYXRlIFJhbmRvbSBVc2VybmFtZQ0KICAgIGRlZiBtYWluX3VzZXJuYW1lKHNlbGYpOg0KICAgICAgICBiZWx1bV9iaXNhKCkNCg0KICAgICMtLT4gQXV0byBHZW5lcmF0ZSBSYW5kb20gSUQNCiAgICBkZWYgbWFpbl9pZChzZWxmKToNCiAgICAgICAgYXcgPSBpbnB1dCgnTWFzdWtrYW4gSUQgQXdhbCBTYmcgQWN1YW4gOiAnKQ0KICAgICAgICBwcmludCgnJykNCiAgICAgICAgcHJpbnQoJ1Rla2FuIGN0cmwrYyBVbnR1ayBCZXJoZW50aScpDQogICAgICAgIHRyeToNCiAgICAgICAgICAgIHNlbGYudGFtcChpbnQoYXcpKQ0KICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6IHBhc3MNCiAgICAgICAgaWYgbGVuKHNlbGYuZHVtcCkgPT0gMDogcHJpbnQoJ1xyRHVtcCBJRCBGQUlMRUQgJykNCiAgICAgICAgZWxzZTogcHJpbnQoJ1xyU3VjY2Vzc2Z1bGx5IEdldCVzIElEJyUoc3RyKGxlbihzZWxmLmR1bXApKSkpDQogICAgZGVmIHRhbXAoc2VsZixhKToNCiAgICAgICAgdCA9IGErMTAwMDANCiAgICAgICAgciA9IHJhbmRvbS5zYW1wbGUocmFuZ2UoYSx0KSwgdC1hKQ0KICAgICAgICByLmFwcGVuZCh0KQ0KICAgICAgICByLnNvcnQoKQ0KICAgICAgICBmb3IgbiBpbiByOg0KICAgICAgICAgICAgc2VsZi5jZWtfaWQobikNCiAgICBkZWYgY2VrX2lkKHNlbGYsaWQpOg0KICAgICAgICB1cmwgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2xvZ2luL2RldmljZS1iYXNlZC9wYXNzd29yZC8/dWlkPSVzJmZsb3c9bG9naW5fbm9fcGluJnJlZnNyYz1kZXByZWNhdGVkJl9yZHInJShpZCkNCiAgICAgICAgdHJ5Og0KICAgICAgICAgICAgcmVxID0gYnMoc2VsZi54eXouZ2V0KHVybCkuY29udGVudCwnaHRtbC5wYXJzZXInKQ0KICAgICAgICAgICAgaWYgIlNvcnJ5LCB0aGlzIGNvbnRlbnQgaXNuJ3QgYXZhaWxhYmxlIHJpZ2h0IG5vdyIgaW4gcmVxOiBwYXNzDQogICAgICAgICAgICBlbGlmICdUZW1wb3JhcmlseSBCbG9ja2VkJyBpbiBzdHIocmVxKToNCiAgICAgICAgICAgICAgICBwcmludCgnXHJBa3VubXUgS2VuYSBTcGFtJyxlbmQ9JycpOyBzeXMuc3Rkb3V0LmZsdXNoKCkNCiAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgbmFtYSA9IHJlcS5maW5kX2FsbCgnaW1nJylbMV1bJ2FsdCddLnNwbGl0KCcsJylbMF0NCiAgICAgICAgICAgICAgICBpZiBuYW1hID09ICdGb3RvIFByb2ZpbCBQZW5nZ3VuYSc6IHBhc3MNCiAgICAgICAgICAgICAgICBlbGlmIG5hbWEgPT0gJyc6IHBhc3MNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBmb3JtYXQgPSAnJXMlcyVzJyUoaWQsc2VsZi5waXNhaCxuYW1hKQ0KICAgICAgICAgICAgICAgICAgICBzZWxmLmR1bXAuYXBwZW5kKGZvcm1hdCkNCiAgICAgICAgICAgICAgICAgICAgYW5pbWFzaSgpDQogICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZTogcGFzcw0KDQojLS0+IFNpbXBhbiBGaWxlIEtlIFBlcmFuZ2thdA0KY2xhc3Mgc2ltcGFuX2ZpbGU6DQogICAgZGVmIF9faW5pdF9fKHNlbGYpOg0KICAgICAgICBzZWxmLm1haW4oKQ0KICAgIGRlZiBtYWluKHNlbGYpOg0KICAgICAgICBwcmludCgnJykNCiAgICAgICAgdHkgPSBpbnB1dCgnU2F2ZSBGaWxlcz8gW3kvdF0gOiAnKS5sb3dlcigpDQogICAgICAgIGlmIHR5IGluIFsnMScsJzAxJywneScsJ3lhJywnaXlhJ106IHNlbGYubWFpbjIoKQ0KICAgICAgICBlbHNlOiBwYXNzDQogICAgZGVmIG1haW4yKHNlbGYpOg0KICAgICAgICB0cnk6b3MubWtkaXIoJ2R1bXAnKQ0KICAgICAgICBleGNlcHQ6cGFzcw0KICAgICAgICB0cnk6DQogICAgICAgICAgICBubSAgPSBpbnB1dCgnV3JpdGUgRmlsZSBOYW1lOiAnKS5yZXBsYWNlKCcgJywnXycpICsgJy50eHQnDQogICAgICAgICAgICBsayAgPSBpbnB1dCgnV3JpdGUgZG93biBTdG9yYWdlIExvY2F0aW9uOiAnKQ0KICAgICAgICAgICAgbG9rID0gJyVzXCVzJyUobGssbm0pDQogICAgICAgICAgICBvcGVuKGxvaywnYSsnKQ0KICAgICAgICAgICAgZm9yIGQgaW4gZHVtcDoNCiAgICAgICAgICAgICAgICB0cnk6IG9wZW4obG9rLCdhKycpLndyaXRlKGQrJ1xuJykNCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IHBhc3MNCiAgICAgICAgICAgIHByaW50KCdcbkR1bXAgRmlsZXMgU3RvcmVkIEluICVzJyUobG9rKSkNCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgcHJpbnQoJ1xuRkFJTEVEICBGaW5kaW5nIEZpbGUgTG9jYXRpb25zJykNCiAgICAgICAgICAgIGxvayA9ICdkdW1wLyVzLnR4dCclKHRhbmdnYWwpDQogICAgICAgICAgICBvcGVuKGxvaywnYSsnKQ0KICAgICAgICAgICAgZm9yIGQgaW4gZHVtcDoNCiAgICAgICAgICAgICAgICB0cnk6IG9wZW4obG9rLCdhKycpLndyaXRlKGQrJ1xuJykNCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6IHBhc3MNCiAgICAgICAgICAgIHByaW50KCdEdW1wIEZpbGVzIFN0b3JlZCBJbiAlcyclKGxvaykpDQoNCiMtLT4gV2FybmluZw0KZGVmIGJlbHVtX2Jpc2EoKToNCiAgICBwcmludCgnU29ycnkgYm9zcywgdGhlIGZlYXR1cmUgaXNudCBhdmFpbGFibGUgeWV0XG5TdGlsbCBkaXp6eSB0aGlua2luZyBhYm91dCB0aGUgbG9naWNcblByYXkgZm9yIGl0IHRvIGJlIGZpbmlzaGVkIHNvb24hXG5Ib3BlZnVsbHkgdGhpcyBTQyBjYW4gaGVscCBhIGxvdCBvZiBwZW9wbGUuLi5cblRoYW5rIHlvdSFcblxuLURBUktXT0xGJykNCiAgICBmaW5pc2goKQ0KICAgIGV4aXQoKQ0KDQojLS0+IFRyaWdnZXINCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6DQogICAgY2xlYXIoKQ0KICAgIHN0YXJ0KCkNCiAgICBsb2dpbigpDQogICAgZmluaXNoKCk="))